System.register(["./bits-b8bc8b22.js","./buffer-barrier-17698e09.js","./scene-asset-10397f71.js","./math-base-02e87bf8.js","./pipeline-state-manager-f4a950fe.js","./deprecated-dacf9914.js","./deprecated-8c84be32.js","./ui-renderer-09c699a1.js"],(function(t){"use strict";var e,i,s,o,n,r,l,h,a,c,u,p,f,d,m,_,b,T,g,v,y,C,E,D,R,L,P,M,O,x,w,N,S,U,k,A,I,B,z;return{setters:[function(t){e=t.m,i=t.F,s=t.d,o=t.A,n=t.G,r=t.l,l=t.H,h=t.I},function(t){a=t.at,c=t.c,u=t.ac,p=t.e,f=t.g,d=t.y},function(t){m=t.a$,_=t.b0,b=t.aM,T=t.a5,g=t.b7,v=t.b_,y=t.bT,C=t.bX,E=t.bU,D=t.bP,R=t.b2,L=t.b1},function(t){P=t.V,M=t.C},function(t){O=t.d},function(t){x=t.k,w=t.a},function(){},function(t){N=t.b,S=t.f,U=t.g,k=t.h,A=t.d,I=t.e,B=t.U,z=t.I}],execute:function(){var F,j,V;t({L:void 0,a:void 0,b:void 0}),function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE"}(F||(F=t("a",{}))),e(F),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER"}(j||(j=t("L",{}))),e(j),function(t){t[t.PT_CORNER=1]="PT_CORNER",t[t.PT_LEFT=2]="PT_LEFT",t[t.PT_BEVEL=4]="PT_BEVEL",t[t.PT_INNERBEVEL=8]="PT_INNERBEVEL"}(V||(V=t("b",{}))),e(V);var W=Math.PI,J=Math.min,G=Math.max,X=Math.cos,Y=Math.sin,q=Math.abs,H=Math.sign,K=.5522847493;function Q(t,e,i,s,o){t.moveTo(e-s,i),t.bezierCurveTo(e-s,i+o*K,e-s*K,i+o,e,i+o),t.bezierCurveTo(e+s*K,i+o,e+s,i+o*K,e+s,i),t.bezierCurveTo(e+s,i-o*K,e+s*K,i-o,e,i-o),t.bezierCurveTo(e-s*K,i-o,e-s,i-o*K,e-s,i),t.close()}function $(t,e,i,s,o,n,r,l,h,a,c){var u,p,f,d,m,_,b,T,g,v,y,C,E,D,R,L;a>10||(m=.5*(n+l),_=.5*(r+h),b=.5*((u=.5*(e+s))+(f=.5*(s+n))),T=.5*((p=.5*(i+o))+(d=.5*(o+r))),((R=q((s-l)*(D=h-i)-(o-h)*(E=l-e)))+(L=q((n-l)*D-(r-h)*E)))*(R+L)<t.tessTol*(E*E+D*D)?t.addPoint(l,h,0===c?c|V.PT_BEVEL:c):($(t,e,i,u,p,b,T,y=.5*(b+(g=.5*(f+m))),C=.5*(T+(v=.5*(d+_))),a+1,0),$(t,y,C,g,v,m,_,l,h,a+1,c)))}var Z,tt,et,it,st,ot,nt,rt,lt,ht,at,ct,ut,pt,ft,dt,mt,_t,bt,Tt,gt,vt,yt,Ct=t("P",function(t){function e(e,i){var s;return(s=t.call(this,e,i)||this).dx=0,s.dy=0,s.dmx=0,s.dmy=0,s.flags=0,s.len=0,s.reset(),s}return i(e,t),e.prototype.reset=function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0},e}(P)),Et=function(){function t(){this.closed=!1,this.bevel=0,this.complex=!0,this.points=[],this.reset()}return t.prototype.reset=function(){this.closed=!1,this.bevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]},t}(),Dt=function(){function t(t){this.dataOffset=0,this.updatePathOffset=!1,this.pathLength=0,this.pathOffset=0,this.paths=[],this.tessTol=.25,this.distTol=.01,this.fillColor=M.WHITE.clone(),this.lineCap=F.BUTT,this.strokeColor=M.BLACK.clone(),this.lineJoin=j.MITER,this.lineWidth=0,this.pointsOffset=0,this._commandX=0,this._commandY=0,this._points=[],this._renderDataList=[],this._curPath=null,this._comp=void 0,this._comp=t}var e=t.prototype;return e.moveTo=function(t,e){this.updatePathOffset&&(this.pathOffset=this.pathLength,this.updatePathOffset=!1),this._addPath(),this.addPoint(t,e,V.PT_CORNER),this._commandX=t,this._commandY=e},e.lineTo=function(t,e){this.addPoint(t,e,V.PT_CORNER),this._commandX=t,this._commandY=e},e.bezierCurveTo=function(t,e,i,s,o,n){var r=this._curPath,l=r.points[r.points.length-1];l&&(l.x!==t||l.y!==e||i!==o||s!==n?($(this,l.x,l.y,t,e,i,s,o,n,0,V.PT_CORNER),this._commandX=o,this._commandY=n):this.lineTo(o,n))},e.quadraticCurveTo=function(t,e,i,s){var o=this._commandX,n=this._commandY;this.bezierCurveTo(o+2/3*(t-o),n+2/3*(e-n),i+2/3*(t-i),s+2/3*(e-s),i,s)},e.arc=function(t,e,i,s,o,n){!function(t,e,i,s,o,n,r){var l,h,a=0,c=0,u=0,p=0,f=0,d=0,m=0,_=0,b=0,T=0,g=0,v=0,y=0,C=0;if(c=n-o,r=r||!1)if(q(c)>=2*W)c=2*W;else for(;c<0;)c+=2*W;else if(q(c)>=2*W)c=2*-W;else for(;c>0;)c-=2*W;for(h=0|G(1,J(q(c)/(.5*W)+.5,5)),u=q(4/3*(1-X(l=c/h/2))/Y(l)),r||(u=-u),C=0;C<=h;C++)d=e+(p=X(a=o+c*(C/h)))*s,m=i+(f=Y(a))*s,_=-f*s*u,b=p*s*u,0===C?t.moveTo(d,m):t.bezierCurveTo(T+v,g+y,d-_,m-b,d,m),T=d,g=m,v=_,y=b}(this,t,e,i,s,o,n)},e.ellipse=function(t,e,i,s){Q(this,t,e,i,s),this._curPath.complex=!1},e.circle=function(t,e,i){Q(this,t,e,i,i),this._curPath.complex=!1},e.rect=function(t,e,i,s){this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.close(),this._curPath.complex=!1},e.roundRect=function(t,e,i,s,o){!function(t,e,i,s,o,n){if(n<.1)t.rect(e,i,s,o);else{var r=J(n,.5*q(s))*H(s),l=J(n,.5*q(o))*H(o);t.moveTo(e,i+l),t.lineTo(e,i+o-l),t.bezierCurveTo(e,i+o-l*(1-K),e+r*(1-K),i+o,e+r,i+o),t.lineTo(e+s-r,i+o),t.bezierCurveTo(e+s-r*(1-K),i+o,e+s,i+o-l*(1-K),e+s,i+o-l),t.lineTo(e+s,i+l),t.bezierCurveTo(e+s,i+l*(1-K),e+s-r*(1-K),i,e+s-r,i),t.lineTo(e+r,i),t.bezierCurveTo(e+r*(1-K),i,e,i+l*(1-K),e,i+l),t.close()}}(this,t,e,i,s,o),this._curPath.complex=!1},e.clear=function(){this.pathLength=0,this.pathOffset=0,this.pointsOffset=0,this.dataOffset=0,this._curPath=null,this.paths.length=0,this._points.length=0;for(var t=this._renderDataList,e=0,i=t.length;e<i;e++){var s=t[e];s&&(N.remove(s),s.removeRenderDrawInfo(this._comp))}this._renderDataList.length=0},e.close=function(){this._curPath.closed=!0},e.requestRenderData=function(){var t=N.add();return this._renderDataList.push(t),t},e.getRenderDataList=function(){return 0===this._renderDataList.length&&this.requestRenderData(),this._renderDataList},e.addPoint=function(t,e,i){var s=this._curPath;if(s){var o=this._points,n=s.points,r=o[this.pointsOffset++];r?(r.x=t,r.y=e):(r=new Ct(t,e),o.push(r)),r.flags=i,n.push(r)}},e._addPath=function(){var t=this.pathLength,e=this.paths[t];return e?e.reset():(e=new Et,this.paths.push(e)),this.pathLength++,this._curPath=e,e},t}(),Rt=S.concat([new a("a_dist",c.R32F)]),Lt=U(Rt),Pt=k(Rt),Mt=t("G",(Z=m("cc.Graphics"),tt=y(),et=C(110),it=E(),st=D(),ot=_(j),nt=D(),rt=_(F),lt=D(),ht=D(),at=D(),ct=D(),ut=R(),Z(pt=tt(pt=et(pt=it((yt=vt=function(t){function e(){var e;return(e=t.call(this)||this).impl=null,e.model=null,l(e,"_lineWidth",dt,h(e)),l(e,"_strokeColor",mt,h(e)),l(e,"_lineJoin",_t,h(e)),l(e,"_lineCap",bt,h(e)),l(e,"_fillColor",Tt,h(e)),l(e,"_miterLimit",gt,h(e)),e._isDrawing=!1,e._isNeedUploadData=!0,e._graphicsUseSubMeshes=[],e._instanceMaterialType=z.ADD_COLOR,e.impl=new Dt(h(e)),e}i(e,t);var n=e.prototype;return n.onRestore=function(){this.impl||this._flushAssembler()},n.onLoad=function(){t.prototype.onLoad.call(this),this.model=x.root.createModel(w),this.model.node=this.model.transform=this.node,this._flushAssembler()},n.onEnable=function(){t.prototype.onEnable.call(this),this._updateMtlForGraphics()},n.onDestroy=function(){this._sceneGetter=null,this.model&&(x.root.destroyModel(this.model),this.model=null);var e=this._graphicsUseSubMeshes.length;if(e>0){for(var i=0;i<e;++i)this._graphicsUseSubMeshes[i].destroy();this._graphicsUseSubMeshes.length=0}this.impl&&(this._isDrawing=!1,this.impl.clear(),this.impl=null),t.prototype.onDestroy.call(this)},n.moveTo=function(t,e){this.impl&&this.impl.moveTo(t,e)},n.lineTo=function(t,e){this.impl&&this.impl.lineTo(t,e)},n.bezierCurveTo=function(t,e,i,s,o,n){this.impl&&this.impl.bezierCurveTo(t,e,i,s,o,n)},n.quadraticCurveTo=function(t,e,i,s){this.impl&&this.impl.quadraticCurveTo(t,e,i,s)},n.arc=function(t,e,i,s,o,n){this.impl&&this.impl.arc(t,e,i,s,o,n)},n.ellipse=function(t,e,i,s){this.impl&&this.impl.ellipse(t,e,i,s)},n.circle=function(t,e,i){this.impl&&this.impl.circle(t,e,i)},n.rect=function(t,e,i,s){this.impl&&this.impl.rect(t,e,i,s)},n.roundRect=function(t,e,i,s,o){this.impl&&this.impl.roundRect(t,e,i,s,o)},n.fillRect=function(t,e,i,s){this.rect(t,e,i,s),this.fill()},n.clear=function(){if(this.impl){if(this.impl.clear(),this._isDrawing=!1,this.model)for(var t=0;t<this.model.subModels.length;t++)this.model.subModels[t].inputAssembler.indexCount=0;this.markForUpdateRenderData()}},n.close=function(){this.impl&&this.impl.close()},n.stroke=function(){this._assembler||this._flushAssembler(),this._isDrawing=!0,this._isNeedUploadData=!0,this._assembler.stroke(this)},n.fill=function(){this._assembler||this._flushAssembler(),this._isDrawing=!0,this._isNeedUploadData=!0,this._assembler.fill(this)},n._updateMtlForGraphics=function(){var t;this._customMaterial?t=this.getMaterialInstance(0):(t=b.get("ui-graphics-material"),this.setMaterial(t,0),(t=this.getMaterialInstance(0)).recompileShaders({USE_LOCAL:!0}))},n.activeSubModel=function(t){if(this.model){if(this.model.subModels.length<=t){var e=O.gfxDevice,i=e.createBuffer(new u(p.VERTEX|p.TRANSFER_DST,f.DEVICE,65535*Pt,Pt)),o=e.createBuffer(new u(p.INDEX|p.TRANSFER_DST,f.DEVICE,131070*Uint16Array.BYTES_PER_ELEMENT,Uint16Array.BYTES_PER_ELEMENT)),n=new T([i],Rt,d.TRIANGLE_LIST,o);n.subMeshIdx=0,this.model.initSubModel(t,n,this.getMaterialInstance(0)),this._graphicsUseSubMeshes.push(n)}}else s(4500,this.node.name)},n._uploadData=function(){var t=this.impl;if(t){var e=t&&t.getRenderDataList();if(!(e.length<=0)&&this.model){for(var i=this.model.subModels,s=0;s<e.length;s++){var o=e[s],n=i[s].inputAssembler;if(o.lastFilledVertex!==o.vertexStart){var r=new Float32Array(o.vData.buffer,0,o.vertexStart*Lt);n.vertexBuffers[0].update(r),n.vertexCount=o.vertexStart;var l=new Uint16Array(o.iData.buffer,0,o.indexStart);n.indexBuffer.update(l),n.indexCount=o.indexStart,o.lastFilledVertex=o.vertexStart,o.lastFilledIndex=o.indexStart}}this._isNeedUploadData=!1}}},n._render=function(t){if(this._isNeedUploadData){if(this.impl){var e=this.impl.getRenderDataList(),i=this.model.subModels.length;if(e.length>i)for(var s=i;s<e.length;s++)this.activeSubModel(s)}this._uploadData()}t.commitModel(this,this.model,this.getMaterialInstance(0))},n._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t)},n._canRender=function(){return!!t.prototype._canRender.call(this)&&!!this.model&&this._isDrawing},n.updateRenderer=function(){t.prototype.updateRenderer.call(this)},n.createRenderEntity=function(){return new A(I.DYNAMIC)},o(e,[{key:"lineWidth",get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this.impl&&(this.impl.lineWidth=t)}},{key:"lineJoin",get:function(){return this._lineJoin},set:function(t){this._lineJoin=t,this.impl&&(this.impl.lineJoin=t)}},{key:"lineCap",get:function(){return this._lineCap},set:function(t){this._lineCap=t,this.impl&&(this.impl.lineCap=t)}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(t){this.impl&&(this._strokeColor.set(t),this.impl.strokeColor=this._strokeColor)}},{key:"fillColor",get:function(){return this._fillColor},set:function(t){this.impl&&(this._fillColor.set(t),this.impl.fillColor=this._fillColor)}},{key:"miterLimit",get:function(){return this._miterLimit},set:function(t){this._miterLimit=t}},{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&this._color.set(t)}},{key:"srcBlendFactor",get:function(){return this._srcBlendFactor},set:function(){}},{key:"dstBlendFactor",get:function(){return this._dstBlendFactor},set:function(){}},{key:"graphicsNativeProxy",get:function(){return this._graphicsNativeProxy}}]),e}(B),vt.LineJoin=j,vt.LineCap=F,n((ft=yt).prototype,"lineWidth",[g,st],Object.getOwnPropertyDescriptor(ft.prototype,"lineWidth"),ft.prototype),n(ft.prototype,"lineJoin",[ot,nt],Object.getOwnPropertyDescriptor(ft.prototype,"lineJoin"),ft.prototype),n(ft.prototype,"lineCap",[rt,lt],Object.getOwnPropertyDescriptor(ft.prototype,"lineCap"),ft.prototype),n(ft.prototype,"strokeColor",[ht],Object.getOwnPropertyDescriptor(ft.prototype,"strokeColor"),ft.prototype),n(ft.prototype,"fillColor",[at],Object.getOwnPropertyDescriptor(ft.prototype,"fillColor"),ft.prototype),n(ft.prototype,"miterLimit",[ct],Object.getOwnPropertyDescriptor(ft.prototype,"miterLimit"),ft.prototype),n(ft.prototype,"color",[v,ut],Object.getOwnPropertyDescriptor(ft.prototype,"color"),ft.prototype),dt=n(ft.prototype,"_lineWidth",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),mt=n(ft.prototype,"_strokeColor",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.BLACK.clone()}}),_t=n(ft.prototype,"_lineJoin",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return j.MITER}}),bt=n(ft.prototype,"_lineCap",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.BUTT}}),Tt=n(ft.prototype,"_fillColor",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.WHITE.clone()}}),gt=n(ft.prototype,"_miterLimit",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),pt=ft))||pt)||pt)||pt)||pt));r.Graphics=Mt}}}));
