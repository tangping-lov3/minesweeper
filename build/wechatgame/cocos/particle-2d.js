System.register(["./bits-b8bc8b22.js","./buffer-barrier-17698e09.js","./scene-asset-10397f71.js","./math-base-02e87bf8.js","./index-f2c2eec3.js","./pipeline-state-manager-f4a950fe.js","./deprecated-dacf9914.js","./touch-37ec7c16.js","./game-1e6d0834.js","./create-mesh-c5031db7.js","./mesh-20100c2c.js","./sprite-renderer-e42860e7.js","./ui-renderer-09c699a1.js","./ZipUtils-3ae2be0b.js"],(function(t){"use strict";var e,r,i,a,n,s,o,l,h,p,u,c,d,f,m,y,g,b,_,v,S,w,C,F,P,D,T,R,A,x,V,I,O,E,z,M,U,k,L,N,B,G,j,W;return{setters:[function(t){e=t.E,r=t.F,i=t.a0,a=t.au,n=t.aC,s=t.aD,o=t.G,l=t.l,h=t.H,p=t.I,u=t.x,c=t.c,d=t.f,f=t.e,m=t.d,y=t.A},function(t){g=t.q},function(t){b=t.a$,_=t.a2,v=t.b1,S=t.b7,w=t.b0,C=t.cr,F=t.bS,P=t.ak,D=t.a,T=t.aM,R=t.a9,A=t.bU,x=t.b5,V=t.bP,I=t.b2,O=t.bV,E=t.aa,z=t.bT},function(t){M=t.V,U=t.C},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(t){k=t.S},function(t){L=t.g,N=t.i,B=t.U,G=t.b},function(t){j=t._,W=t.c}],execute:function(){var Y,H,q,X,Z=e({GRAVITY:0,RADIUS:1}),J=e({FREE:0,RELATIVE:1,GROUPED:2}),K=new M(0,0),Q=new M,$=new M,tt=new M,et=new M,rt=L(N),it=function(){this.pos=new M(0,0),this.startPos=new M(0,0),this.color=new U(0,0,0,255),this.deltaColor={r:0,g:0,b:0,a:255},this.size=0,this.deltaSize=0,this.rotation=0,this.deltaRotation=0,this.timeToLive=0,this.drawPos=new M(0,0),this.aspectRatio=1,this.dir=new M(0,0),this.radialAccel=0,this.tangentialAccel=0,this.angle=0,this.degreesPerSecond=0,this.radius=0,this.deltaRadius=0},at=new(function(t){function e(){return t.apply(this,arguments)||this}return r(e,t),e.prototype.get=function(){return this._get()||new it},e}(i))((function(t){t.pos.set(K),t.startPos.set(K),t.color._val=4278190080,t.deltaColor.r=t.deltaColor.g=t.deltaColor.b=0,t.deltaColor.a=255,t.size=0,t.deltaSize=0,t.rotation=0,t.deltaRotation=0,t.timeToLive=0,t.drawPos.set(K),t.aspectRatio=1,t.dir.set(K),t.radialAccel=0,t.tangentialAccel=0,t.angle=0,t.degreesPerSecond=0,t.radius=0,t.deltaRadius=0}),1024),nt=function(){function t(t){this.particles=[],this.active=!1,this.uvFilled=0,this.finished=!1,this.readyToPlay=!0,this.elapsed=0,this.emitCounter=0,this._worldRotation=0,this.sys=t,this.particles=[],this.active=!1,this.readyToPlay=!0,this.finished=!1,this.elapsed=0,this.emitCounter=0,this.uvFilled=0,this._worldRotation=0}var e=t.prototype;return e.stop=function(){this.active=!1,this.readyToPlay=!1,this.elapsed=this.sys.duration,this.emitCounter=0},e.reset=function(){this.active=!0,this.readyToPlay=!0,this.elapsed=0,this.emitCounter=0,this.finished=!1;for(var t=this.particles,e=0;e<t.length;++e)at.put(t[e]);t.length=0},e.emitParticle=function(t){var e=this.sys,r=at.get();this.particles.push(r),r.timeToLive=e.life+e.lifeVar*(Math.random()-.5)*2;var i=r.timeToLive=Math.max(0,r.timeToLive);r.pos.x=e.sourcePos.x+e.posVar.x*(Math.random()-.5)*2,r.pos.y=e.sourcePos.y+e.posVar.y*(Math.random()-.5)*2;var o,l,h,p,u=e.startColor,c=e.startColorVar,d=e.endColor,f=e.endColorVar;r.color.r=o=a(u.r+c.r*(Math.random()-.5)*2,0,255),r.color.g=l=a(u.g+c.g*(Math.random()-.5)*2,0,255),r.color.b=h=a(u.b+c.b*(Math.random()-.5)*2,0,255),r.color.a=p=a(u.a+c.a*(Math.random()-.5)*2,0,255),r.deltaColor.r=(a(d.r+f.r*(Math.random()-.5)*2,0,255)-o)/i,r.deltaColor.g=(a(d.g+f.g*(Math.random()-.5)*2,0,255)-l)/i,r.deltaColor.b=(a(d.b+f.b*(Math.random()-.5)*2,0,255)-h)/i,r.deltaColor.a=(a(d.a+f.a*(Math.random()-.5)*2,0,255)-p)/i;var m=e.startSize+e.startSizeVar*(Math.random()-.5)*2;if(m=Math.max(0,m),r.size=m,-1===e.endSize)r.deltaSize=0;else{var y=e.endSize+e.endSizeVar*(Math.random()-.5)*2;y=Math.max(0,y),r.deltaSize=(y-m)/i}var g=e.startSpin+e.startSpinVar*(Math.random()-.5)*2,b=e.endSpin+e.endSpinVar*(Math.random()-.5)*2;r.rotation=g,r.deltaRotation=(b-g)/i,r.startPos.x=t.x,r.startPos.y=t.y,r.aspectRatio=e.aspectRatio||1;var _=n(e.angle+this._worldRotation+e.angleVar*(Math.random()-.5)*2);if(e.emitterMode===Z.GRAVITY){var v=e.speed+e.speedVar*(Math.random()-.5)*2;r.dir.x=Math.cos(_),r.dir.y=Math.sin(_),r.dir.multiplyScalar(v),r.radialAccel=e.radialAccel+e.radialAccelVar*(Math.random()-.5)*2,r.tangentialAccel=e.tangentialAccel+e.tangentialAccelVar*(Math.random()-.5)*2,e.rotationIsDir&&(r.rotation=-s(Math.atan2(r.dir.y,r.dir.x)))}else{var S=e.startRadius+e.startRadiusVar*(Math.random()-.5)*2,w=e.endRadius+e.endRadiusVar*(Math.random()-.5)*2;r.radius=S,r.deltaRadius=-1===e.endRadius?0:(w-S)/i,r.angle=_,r.degreesPerSecond=n(e.rotatePerS+e.rotatePerSVar*(Math.random()-.5)*2)}},e.updateUVs=function(t){var e=this.renderData;if(e&&this.sys._renderSpriteFrame){for(var r=e.vData,i=this.sys._renderSpriteFrame.uv,a=t?0:this.uvFilled,n=this.particles.length,s=a;s<n;s++){var o=s*rt*4;r[o+3]=i[0],r[o+4]=i[1],r[o+12]=i[2],r[o+13]=i[3],r[o+21]=i[4],r[o+22]=i[5],r[o+30]=i[6],r[o+31]=i[7]}this.uvFilled=n}},e.updateParticleBuffer=function(t,e,r,i){var a=r.vData,s=e.x,o=e.y,l=t.size,h=l,p=t.aspectRatio;p>1?h=l/p:l=h*p;var u=l/2,c=h/2;if(t.rotation){var d=-u,f=-c,m=u,y=c,g=-n(t.rotation),b=Math.cos(g),_=Math.sin(g);a[i]=d*b-f*_+s,a[i+1]=d*_+f*b+o,a[i+2]=0,a[i+9]=m*b-f*_+s,a[i+10]=m*_+f*b+o,a[i+11]=0,a[i+18]=d*b-y*_+s,a[i+19]=d*_+y*b+o,a[i+20]=0,a[i+27]=m*b-y*_+s,a[i+28]=m*_+y*b+o,a[i+29]=0}else a[i]=s-u,a[i+1]=o-c,a[i+2]=0,a[i+9]=s+u,a[i+10]=o-c,a[i+11]=0,a[i+18]=s-u,a[i+19]=o+c,a[i+20]=0,a[i+27]=s+u,a[i+28]=o+c,a[i+29]=0;U.toArray(a,t.color,i+5),U.toArray(a,t.color,i+14),U.toArray(a,t.color,i+23),U.toArray(a,t.color,i+32)},e.step=function(t){var e=this.sys.assembler,r=this.sys,i=r.node,a=this.particles;if(t=t>e.maxParticleDeltaTime?e.maxParticleDeltaTime:t,i.updateWorldTransform(),r.positionType===J.FREE){this._worldRotation=function(t){for(var e=0,r=t;r;)e+=r.eulerAngles.z,r=r.parent;return e}(i);var n=i.worldMatrix;Q.x=n.m12,Q.y=n.m13}else r.positionType===J.RELATIVE?(this._worldRotation=i.eulerAngles.z,Q.x=i.position.x,Q.y=i.position.y):this._worldRotation=0;if(this.active&&r.emissionRate){var s=1/r.emissionRate;for(a.length<r.totalParticles&&(this.emitCounter+=t);a.length<r.totalParticles&&this.emitCounter>s;)this.emitParticle(Q),this.emitCounter-=s;this.elapsed+=t,-1!==r.duration&&r.duration<this.elapsed&&r.stopSystem()}var o=this.renderData,l=a.length;o.reset(),this.requestData(4*l,6*l),l>this.uvFilled&&this.updateUVs();for(var h=0;h<a.length;){$.x=$.y=tt.x=tt.y=et.x=et.y=0;var p=a[h];if(p.timeToLive-=t,p.timeToLive>0){if(r.emitterMode===Z.GRAVITY){var u=et,c=$,d=tt;(p.pos.x||p.pos.y)&&(c.set(p.pos),c.normalize()),d.set(c),c.multiplyScalar(p.radialAccel);var f=d.x;d.x=-d.y,d.y=f,d.multiplyScalar(p.tangentialAccel),u.set(c),u.add(d),u.add(r.gravity),u.multiplyScalar(t),p.dir.add(u),u.set(p.dir),u.multiplyScalar(t),p.pos.add(u)}else p.angle+=p.degreesPerSecond*t,p.radius+=p.deltaRadius*t,p.pos.x=-Math.cos(p.angle)*p.radius,p.pos.y=-Math.sin(p.angle)*p.radius;p.color.r+=p.deltaColor.r*t,p.color.g+=p.deltaColor.g*t,p.color.b+=p.deltaColor.b*t,p.color.a+=p.deltaColor.a*t,p.size+=p.deltaSize*t,p.size<0&&(p.size=0),p.rotation+=p.deltaRotation*t;var m=$;m.set(p.pos),r.positionType!==J.GROUPED&&m.add(p.startPos);var y=rt*h*4;this.updateParticleBuffer(p,m,o,y),++h}else{var g=a[h];h!==a.length-1&&(a[h]=a[a.length-1]),at.put(g),a.length--,o.resize(o.vertexCount-4,o.indexCount-6)}}this.renderData.material=this.sys.getRenderMaterial(0),this.renderData.frame=this.sys._renderSpriteFrame,o.setRenderDrawInfoAttributes(),0!==a.length||this.active||this.readyToPlay||(this.finished=!0,r._finishedSimulation())},e.requestData=function(t,e){var r=this.renderData.indexCount;this.renderData.request(t,e);for(var i=this.renderData.indexCount/6,a=this.renderData.iData,n=r;n<i;n++){var s=4*n;a[r++]=s,a[r++]=s+1,a[r++]=s+2,a[r++]=s+1,a[r++]=s+3,a[r++]=s+2}},e.initDrawInfo=function(){this.renderData.setRenderDrawInfoAttributes()},t}(),st=t("ParticleAsset",b("cc.ParticleAsset")((X=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,h(e,"spriteFrame",q,p(e)),e}return r(e,t),e}(_),q=o((H=X).prototype,"spriteFrame",[v,S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=H))||Y);l.ParticleAsset=st;var ot,lt,ht,pt,ut,ct,dt,ft,mt,yt,gt,bt,_t,vt,St,wt,Ct,Ft,Pt,Dt,Tt,Rt,At,xt,Vt,It,Ot,Et,zt,Mt,Ut,kt,Lt,Nt,Bt,Gt,jt,Wt,Yt,Ht,qt,Xt,Zt,Jt,Kt,Qt,$t,te,ee,re,ie,ae,ne,se,oe,le,he,pe,ue,ce,de,fe,me,ye,ge,be,_e,ve,Se,we,Ce,Fe,Pe,De,Te,Re,Ae,xe,Ve,Ie,Oe,Ee,ze,Me,Ue,ke,Le,Ne,Be,Ge,je,We,Ye,He,qe,Xe,Ze,Je,Ke,Qe,$e,tr,er,rr=function(){function t(t){var e,r=this;this.pos=8,this.palette=[],this.imgData=[],this.text={},this.width=0,this.height=0,this.bits=0,this.colorType=0,this.compressionMethod=0,this.filterMethod=0,this.interlaceMethod=0,this.colors=0,this.hasAlphaChannel=!1,this.pixelBitlength=0,this.data=t,this.transparency={indexed:[],rgb:0,grayscale:0};for(var i=0,a=0,n=0;;){n=this.readUInt32();var s=function(){var t=[];for(i=0;i<4;++i)t.push(String.fromCharCode(r.data[r.pos++]));return t}.call(this).join("");switch(s){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(n);break;case"fcTL":e&&this.animation.frames.push(e),this.pos+=4,e={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};var o=this.readUInt16(),l=this.readUInt16()||100;e.delay=1e3*o/l,e.disposeOp=this.data[this.pos++],e.blendOp=this.data[this.pos++],e.data=[];break;case"IDAT":case"fdAT":for("fdAT"===s&&(this.pos+=4,n-=4),t=(null!=e?e.data:void 0)||this.imgData,i=0;n>=0?i<n:i>n;n>=0?++i:--i)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:this.transparency.indexed=this.read(n);var h=255-this.transparency.indexed.length;if(h>0)for(a=0;h>=0?a<h:a>h;h>=0?++a:--a)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(n)[0];break;case 2:this.transparency.rgb=this.read(n)}break;case"tEXt":var p=this.read(n),c=p.indexOf(0),d=String.fromCharCode.apply(String,p.slice(0,c));this.text[d]=String.fromCharCode.apply(String,p.slice(c+1));break;case"IEND":e&&this.animation.frames.push(e),this.colors=function(){switch(r.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this);var f=this.colorType;this.hasAlphaChannel=4===f||6===f;var m=this.colors+(this.hasAlphaChannel?1:0);return this.pixelBitlength=this.bits*m,this.colorSpace=function(){switch(r.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData instanceof Uint8Array||(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=n}if(this.pos+=4,this.pos>this.data.length)throw new Error(u(6017))}}var e=t.prototype;return e.read=function(t){var e=0,r=[];for(e=0;t>=0?e<t:e>t;t>=0?++e:--e)r.push(this.data[this.pos++]);return r},e.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},e.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},e.decodePixels=function(t){if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);t=new j.Inflate(t,{index:0,verify:!1}).decompress();for(var e=this.pixelBitlength/8,r=e*this.width,i=new Uint8Array(r*this.height),a=t.length,n=0,s=0,o=0,l=0,h=0,p=0,c=0,d=0,f=0,m=0,y=0,g=0,b=0,_=0,v=0,S=0,w=0,C=0,F=0;s<a;){switch(t[s++]){case 0:for(p=c=0;c<r;p=c+=1)i[o++]=t[s++];break;case 1:for(p=d=0;d<r;p=d+=1)l=t[s++],g=p<e?0:i[o-e],i[o++]=(l+g)%256;break;case 2:for(p=f=0;f<r;p=f+=1)l=t[s++],h=(p-p%e)/e,C=n&&i[(n-1)*r+h*e+p%e],i[o++]=(C+l)%256;break;case 3:for(p=m=0;m<r;p=m+=1)l=t[s++],h=(p-p%e)/e,g=p<e?0:i[o-e],C=n&&i[(n-1)*r+h*e+p%e],i[o++]=(l+Math.floor((g+C)/2))%256;break;case 4:for(p=y=0;y<r;p=y+=1)l=t[s++],h=(p-p%e)/e,g=p<e?0:i[o-e],0===n?C=F=0:(C=i[(n-1)*r+h*e+p%e],F=h&&i[(n-1)*r+(h-1)*e+p%e]),b=g+C-F,_=Math.abs(b-g),S=Math.abs(b-C),w=Math.abs(b-F),v=_<=S&&_<=w?g:S<=w?C:F,i[o++]=(l+v)%256;break;default:throw new Error(u(6018,t[s-1]))}n++}return i},e.copyToImageData=function(t,e){var r,i=this.hasAlphaChannel,a=this.colors;this.palette.length&&(r=null!=this._decodedPalette?this._decodedPalette:this._decodedPalette=this.decodePalette(),a=4,i=!0);var n=t.data||t,s=n.length,o=r||e,l=0,h=0,p=0,u=0;if(1===a)for(;l<s;)p=r?4*e[l/4]:h,u=o[p++],n[l++]=u,n[l++]=u,n[l++]=u,n[l++]=i?o[p++]:255,h=p;else for(;l<s;)p=r?4*e[l/4]:h,n[l++]=o[p++],n[l++]=o[p++],n[l++]=o[p++],n[l++]=i?o[p++]:255,h=p},e.decodePalette=function(){for(var t=this.palette,e=this.transparency.indexed||[],r=new Uint8Array((e.length||0)+t.length),i=0,a=0,n=0,s=0,o=0,l=t.length;o<l;s=o+=3)r[i++]=t[s],r[i++]=t[s+1],r[i++]=t[s+2],n=e[a++],r[i++]=null!=n?n:255;return r},e.render=function(t){t.width=this.width,t.height=this.height;var e=t.getContext("2d"),r=e.createImageData(this.width,this.height);return this.copyToImageData(r,this.decodePixels(null)),e.putImageData(r,0,0)},t}(),ir=function(){function t(){this._littleEndian=!1,this._tiffData=[],this._fileDirectories=[]}var e=t.prototype;return e.getUint8=function(t){return this._tiffData[t]},e.getUint16=function(t){return this._littleEndian?this._tiffData[t+1]<<8|this._tiffData[t]:this._tiffData[t]<<8|this._tiffData[t+1]},e.getUint32=function(t){var e=this._tiffData;return this._littleEndian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},e.checkLittleEndian=function(){var t=this.getUint16(0);if(18761===t)this._littleEndian=!0;else{if(19789!==t)throw console.log(t),TypeError(u(6019));this._littleEndian=!1}return this._littleEndian},e.hasTowel=function(){if(42!==this.getUint16(2))throw RangeError(u(6020));return!0},e.getFieldTypeName=function(t){return t in nr?nr[t]:null},e.getFieldTagName=function(t){return t in ar?ar[t]:(c(6021,t),"Tag"+t)},e.getFieldTypeLength=function(t){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(t)?1:-1!==["SHORT","SSHORT"].indexOf(t)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(t)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)?8:0},e.getFieldValues=function(t,e,r,i){var a=[],n=this.getFieldTypeLength(e);if(n*r<=4)!1===this._littleEndian?a.push(i>>>8*(4-n)):a.push(i);else for(var s=0;s<r;s++){var o=n*s;n>=8?-1!==["RATIONAL","SRATIONAL"].indexOf(e)?(a.push(this.getUint32(i+o)),a.push(this.getUint32(i+o+4))):c(8e3):a.push(this.getBytes(n,i+o))}return"ASCII"===e&&a.forEach((function(t,e,r){r[e]=String.fromCharCode(t)})),a},e.getBytes=function(t,e){if(t<=0)c(8001);else{if(t<=1)return this.getUint8(e);if(t<=2)return this.getUint16(e);if(t<=3)return this.getUint32(e)>>>8;if(t<=4)return this.getUint32(e);c(8002)}return 0},e.getBits=function(t,e,r){r=r||0;var i=e+Math.floor(r/8),a=r+t,n=32-t,s=0,o=0;return a<=0?c(6023):a<=8?(s=24+r,o=this.getUint8(i)):a<=16?(s=16+r,o=this.getUint16(i)):a<=32?(s=r,o=this.getUint32(i)):c(6022),{bits:o<<s>>>n,byteOffset:i+Math.floor(a/8),bitOffset:a%8}},e.parseFileDirectory=function(t){var e=this.getUint16(t),r=[],i=0,a=0;for(i=t+2,a=0;a<e;i+=12,a++){var n=this.getUint16(i),s=this.getUint16(i+2),o=this.getUint32(i+4),l=this.getUint32(i+8),h=this.getFieldTagName(n),p=this.getFieldTypeName(s),u=this.getFieldValues(h,p,o,l);r[h]={type:p,values:u}}this._fileDirectories.push(r);var c=this.getUint32(i);0!==c&&this.parseFileDirectory(c)},e.clampColorSample=function(t,e){var r=Math.pow(2,8-e);return Math.floor(t*r+(r-1))},e.parseTIFF=function(t,e){var r=this;if(e=e||document.createElement("canvas"),this._tiffData=t,this._canvas=e,this.checkLittleEndian(),this.hasTowel()){var i=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(i);var a=this._fileDirectories[0],n=a.ImageWidth.values[0],s=a.ImageLength.values[0];this._canvas.width=n,this._canvas.height=s;var o=[],l=a.Compression?a.Compression.values[0]:1,h=a.SamplesPerPixel.values[0],p=[],d=0,f=!1;a.BitsPerSample.values.forEach((function(t,e){p[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void 0},t%8==0&&(p[e].hasBytesPerSample=!0,p[e].bytesPerSample=t/8),d+=t}),this);var m=0;d%8==0&&(f=!0,m=d/8);var y,g=a.StripOffsets.values,b=g.length;if(a.StripByteCounts)y=a.StripByteCounts.values;else{if(c(8003),1!==b)throw Error(u(6024));y=[Math.ceil(n*s*d/8)]}for(var _=1,v=1,S=0;S<b;S++){var w=g[S];o[S]=[];for(var C=y[S],F=0,P=0,D=1,T=!0,R=[],A=0,x=0,V=0;F<C;F+=D)switch(l){case 1:R=[];for(var I=0;I<h;I++){var O=p[I];if(!O.hasBytesPerSample){var E=this.getBits(O.bitsPerSample,w+F,P);throw R.push(E.bits),F=E.byteOffset-w,P=E.bitOffset,RangeError(u(6025))}var z=O.bytesPerSample*I;R.push(this.getBytes(O.bytesPerSample,w+F+z))}if(o[S].push(R),!f)throw D=0,RangeError(u(6026));D=m;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(T){T=!1;var M=this.getUint8(w+F);M>=0&&M<=127?_=M+1:M>=-127&&M<=-1?v=1-M:T=!0}else{for(var U=this.getUint8(w+F),k=0;k<v;k++){var L=p[x];if(!L.hasBytesPerSample)throw RangeError(u(6025));V=V<<8*A|U,++A===L.bytesPerSample&&(R.push(V),V=A=0,x++),x===h&&(o[S].push(R),R=[],x=0)}0==--_&&(T=!0)}D=1}}if(e.getContext){var N=this._canvas.getContext("2d");N.fillStyle="rgba(255, 255, 255, 0)";var B=a.RowsPerStrip?a.RowsPerStrip.values[0]:s,G=o.length,j=s%B,W=0===j?B:j,Y=B,H=0,q=a.PhotometricInterpretation.values[0],X=[],Z=0;a.ExtraSamples&&(Z=(X=a.ExtraSamples.values).length);var J=[],K=0;a.ColorMap&&(J=a.ColorMap.values,K=Math.pow(2,p[0].bitsPerSample));for(var Q=0;Q<G;Q++){Q+1===G&&(Y=W);for(var $=o[Q].length,tt=H*Q,et=0,rt=0;et<Y&&rt<$;et++)for(var it=0;it<n;it++,rt++){var at=o[Q][rt],nt=0,st=0,ot=0,lt=1;if(Z>0)for(var ht=0;ht<Z;ht++)if(1===X[ht]||2===X[ht]){lt=at[3+ht]/256;break}!function(){switch(q){case 0:var t=0;p[0].hasBytesPerSample&&(t=Math.pow(16,2*p[0].bytesPerSample)),at.forEach((function(e,r,i){i[r]=t-e}));case 1:nt=st=ot=r.clampColorSample(at[0],p[0].bitsPerSample);break;case 2:nt=r.clampColorSample(at[0],p[0].bitsPerSample),st=r.clampColorSample(at[1],p[1].bitsPerSample),ot=r.clampColorSample(at[2],p[2].bitsPerSample);break;case 3:if(void 0===J)throw Error(u(6027));var e=at[0];nt=r.clampColorSample(J[e],16),st=r.clampColorSample(J[K+e],16),ot=r.clampColorSample(J[2*K+e],16);break;default:throw RangeError(u(6028,q))}}(),N.fillStyle="rgba("+nt+", "+st+", "+ot+", "+lt+")",N.fillRect(it,tt+et,1,1)}H=Y}}return this._canvas}},t}(),ar={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},nr={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"};function sr(t){var e=t.parent,r=t.getComponent(wr);return e&&r?sr(e):t.getComponentsInChildren(wr)}!function(t){t[t.JPG=0]="JPG",t[t.PNG=1]="PNG",t[t.TIFF=2]="TIFF",t[t.WEBP=3]="WEBP",t[t.PVR=4]="PVR",t[t.ETC=5]="ETC",t[t.S3TC=6]="S3TC",t[t.ATITC=7]="ATITC",t[t.TGA=8]="TGA",t[t.RAWDATA=9]="RAWDATA",t[t.UNKNOWN=10]="UNKNOWN"}(er||(er={}));var or,lr,hr,pr,ur,cr,dr,fr,mr,yr,gr,br,_r,vr,Sr,wr=t("ParticleSystem2D",(ot=b("cc.ParticleSystem2D"),lt=A(),ht=x(),pt=V(),ut=w(st),ct=x(),dt=V(),ft=w(k),mt=V(),yt=V(),gt=V(),bt=V(),_t=V(),vt=V(),St=V(),wt=V(),Ct=I(),Ft=V(),Pt=V(),Dt=V(),Tt=V(),Rt=V(),At=V(),xt=V(),Vt=V(),It=V(),Ot=V(),Et=V(),zt=V(),Mt=V(),Ut=w(J),kt=V(),Lt=x(),Nt=V(),Bt=w(Z),Gt=V(),jt=V(),Wt=V(),Yt=V(),Ht=V(),qt=V(),Xt=V(),Zt=V(),Jt=V(),Kt=V(),Qt=V(),$t=V(),te=V(),ee=V(),re=V(),ie=x(),ae=V(),ne=x(),se=V(),oe=O("preview"),ot(le=lt(le=C(le=F((tr=$e=function(t){function e(){var e;return e=t.call(this)||this,h(e,"duration",pe,p(e)),h(e,"emissionRate",ue,p(e)),h(e,"life",ce,p(e)),h(e,"lifeVar",de,p(e)),h(e,"angle",fe,p(e)),h(e,"angleVar",me,p(e)),h(e,"startSize",ye,p(e)),h(e,"startSizeVar",ge,p(e)),h(e,"endSize",be,p(e)),h(e,"endSizeVar",_e,p(e)),h(e,"startSpin",ve,p(e)),h(e,"startSpinVar",Se,p(e)),h(e,"endSpin",we,p(e)),h(e,"endSpinVar",Ce,p(e)),h(e,"sourcePos",Fe,p(e)),h(e,"posVar",Pe,p(e)),h(e,"emitterMode",De,p(e)),h(e,"gravity",Te,p(e)),h(e,"speed",Re,p(e)),h(e,"speedVar",Ae,p(e)),h(e,"tangentialAccel",xe,p(e)),h(e,"tangentialAccelVar",Ve,p(e)),h(e,"radialAccel",Ie,p(e)),h(e,"radialAccelVar",Oe,p(e)),h(e,"rotationIsDir",Ee,p(e)),h(e,"startRadius",ze,p(e)),h(e,"startRadiusVar",Me,p(e)),h(e,"endRadius",Ue,p(e)),h(e,"endRadiusVar",ke,p(e)),h(e,"rotatePerS",Le,p(e)),h(e,"rotatePerSVar",Ne,p(e)),e.aspectRatio=1,h(e,"playOnLoad",Be,p(e)),h(e,"autoRemoveOnFinish",Ge,p(e)),h(e,"_preview",je,p(e)),h(e,"_custom",We,p(e)),h(e,"_file",Ye,p(e)),h(e,"_spriteFrame",He,p(e)),h(e,"_totalParticles",qe,p(e)),h(e,"_startColor",Xe,p(e)),h(e,"_startColorVar",Ze,p(e)),h(e,"_endColor",Je,p(e)),h(e,"_endColorVar",Ke,p(e)),h(e,"_positionType",Qe,p(e)),e._stopped=!0,e.initProperties(),e}r(e,t);var i=e.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this._updateMaterial(),this._updatePositionType()},i.onDestroy=function(){t.prototype.onDestroy.call(this),this.autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._simulator.uvFilled=0,this._simulator.renderData&&this._assembler&&this._assembler.removeData(this._simulator.renderData)},i.initProperties=function(){this._previewTimer=null,this._focused=!1,this.aspectRatio=1,this._simulator=new nt(this)},i.onFocusInEditor=function(){this._focused=!0;for(var t=sr(this.node),e=0;e<t.length;++e)t[e]._startPreview()},i.onLostFocusInEditor=function(){this._focused=!1;for(var t=sr(this.node),e=0;e<t.length;++e)t[e]._stopPreview()},i._startPreview=function(){this._preview&&this.resetSystem()},i._stopPreview=function(){this._preview&&(this.resetSystem(),this.stopSystem()),this._previewTimer&&clearInterval(this._previewTimer)},i.__preload=function(){t.prototype.__preload.call(this),this._custom&&this.spriteFrame&&!this._renderSpriteFrame?this._applySpriteFrame():this._file&&(this._custom?!this._getTexture()&&this._applyFile():this._applyFile()),this.playOnLoad&&this.resetSystem()},i._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t),this._assembler&&this._assembler.createData&&(this._simulator.renderData=this._assembler.createData(this),this._simulator.renderData.particleInitRenderDrawInfo(this.renderEntity),this._simulator.initDrawInfo())},i.lateUpdate=function(t){this._simulator.finished||this._simulator.step(t)},i.addParticle=function(){},i.stopSystem=function(){this._stopped=!0,this._simulator.stop()},i.resetSystem=function(){this._stopped=!1,this._simulator.reset(),this.markForUpdateRenderData()},i.isFull=function(){return this.particleCount>=this.totalParticles},i._applyFile=function(){var t=this._file;if(t){if(!t)return void d(6029);if(!this.isValid)return;this._plistFile=t.nativeUrl,this._custom||(this._spriteFrame!==t.spriteFrame&&(this.spriteFrame=t.spriteFrame),this._initWithDictionary(t._nativeAsset)),this._spriteFrame?!this._renderSpriteFrame&&this._spriteFrame&&this._applySpriteFrame():t.spriteFrame?this.spriteFrame=t.spriteFrame:this._custom&&this._initTextureWithDictionary(t._nativeAsset)}},i._initTextureWithDictionary=function(t){var e,r=this;if(t.spriteFrameUuid){var i=t.spriteFrameUuid;P.loadAny(i,(function(e,i){e?(t.spriteFrameUuid=void 0,r._initTextureWithDictionary(t),f(e)):r.spriteFrame=i}))}else{var a=D(this._plistFile,t.textureFileName||"");if(t.textureFileName)P.loadRemote(a,(function(e,i){e?(t.textureFileName=void 0,r._initTextureWithDictionary(t),f(e)):r.spriteFrame=i?k.createWithImage(i):k.createWithImage(T.get("white-texture"))}));else if(t.textureImageData){var n=t.textureImageData;if(!(n&&n.length>0))return!1;var s=P.assets.get(a);if(!s){var o=W.unzipBase64AsArray(n,1);if(!o)return m(6030,this._file.name),!1;var l=(e=o).length>8&&137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&13===e[4]&&10===e[5]&&26===e[6]&&10===e[7]?er.PNG:e.length>2&&(73===e[0]&&73===e[1]||77===e[0]&&77===e[1]||255===e[0]&&216===e[1])?er.TIFF:er.UNKNOWN;if(l!==er.TIFF&&l!==er.PNG)return m(6031,this._file.name),!1;var h=document.createElement("canvas");l===er.PNG?new rr(o).render(h):(this._tiffReader||(this._tiffReader=new ir),this._tiffReader.parseTIFF(o,h)),s=new R(h),P.assets.add(a,s)}s||m(6032,this._file.name),this.spriteFrame=s?k.createWithImage(s):k.createWithImage(T.get("white-texture"))}}return!0},i._initWithDictionary=function(t){this.totalParticles=parseInt(t.maxParticles||0),this.life=parseFloat(t.particleLifespan||0),this.lifeVar=parseFloat(t.particleLifespanVariance||0);var e=t.emissionRate;this.emissionRate=e||Math.min(this.totalParticles/this.life,Number.MAX_VALUE),this.duration=parseFloat(t.duration||0),this._srcBlendFactor=parseInt(t.blendFuncSource||g.SRC_ALPHA),this._dstBlendFactor=parseInt(t.blendFuncDestination||g.ONE_MINUS_SRC_ALPHA);var r=this._startColor;r.r=255*parseFloat(t.startColorRed||0),r.g=255*parseFloat(t.startColorGreen||0),r.b=255*parseFloat(t.startColorBlue||0),r.a=255*parseFloat(t.startColorAlpha||0);var i=this._startColorVar;i.r=255*parseFloat(t.startColorVarianceRed||0),i.g=255*parseFloat(t.startColorVarianceGreen||0),i.b=255*parseFloat(t.startColorVarianceBlue||0),i.a=255*parseFloat(t.startColorVarianceAlpha||0);var a=this._endColor;a.r=255*parseFloat(t.finishColorRed||0),a.g=255*parseFloat(t.finishColorGreen||0),a.b=255*parseFloat(t.finishColorBlue||0),a.a=255*parseFloat(t.finishColorAlpha||0);var n=this._endColorVar;if(n.r=255*parseFloat(t.finishColorVarianceRed||0),n.g=255*parseFloat(t.finishColorVarianceGreen||0),n.b=255*parseFloat(t.finishColorVarianceBlue||0),n.a=255*parseFloat(t.finishColorVarianceAlpha||0),this.startSize=parseFloat(t.startParticleSize||0),this.startSizeVar=parseFloat(t.startParticleSizeVariance||0),this.endSize=parseFloat(t.finishParticleSize||0),this.endSizeVar=parseFloat(t.finishParticleSizeVariance||0),this.positionType=parseFloat(void 0!==t.positionType?t.positionType:J.FREE),this.sourcePos.set(0,0),this.posVar.set(parseFloat(t.sourcePositionVariancex||0),parseFloat(t.sourcePositionVariancey||0)),this.angle=parseFloat(t.angle||0),this.angleVar=parseFloat(t.angleVariance||0),this.startSpin=parseFloat(t.rotationStart||0),this.startSpinVar=parseFloat(t.rotationStartVariance||0),this.endSpin=parseFloat(t.rotationEnd||0),this.endSpinVar=parseFloat(t.rotationEndVariance||0),this.emitterMode=parseInt(t.emitterType||Z.GRAVITY),this.emitterMode===Z.GRAVITY){this.gravity.set(parseFloat(t.gravityx||0),parseFloat(t.gravityy||0)),this.speed=parseFloat(t.speed||0),this.speedVar=parseFloat(t.speedVariance||0),this.radialAccel=parseFloat(t.radialAcceleration||0),this.radialAccelVar=parseFloat(t.radialAccelVariance||0),this.tangentialAccel=parseFloat(t.tangentialAcceleration||0),this.tangentialAccelVar=parseFloat(t.tangentialAccelVariance||0);var s=t.rotationIsDir||"";null!==s?(s=s.toString().toLowerCase(),this.rotationIsDir="true"===s||"1"===s):this.rotationIsDir=!1}else{if(this.emitterMode!==Z.RADIUS)return m(6009),!1;this.startRadius=parseFloat(t.maxRadius||0),this.startRadiusVar=parseFloat(t.maxRadiusVariance||0),this.endRadius=parseFloat(t.minRadius||0),this.endRadiusVar=parseFloat(t.minRadiusVariance||0),this.rotatePerS=parseFloat(t.rotatePerSecond||0),this.rotatePerSVar=parseFloat(t.rotatePerSecondVariance||0)}return this._initTextureWithDictionary(t),!0},i._syncAspect=function(){if(this._renderSpriteFrame){var t=this._renderSpriteFrame.rect;this.aspectRatio=t.width/t.height}},i._applySpriteFrame=function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame?this._renderSpriteFrame.texture&&(this._simulator.updateUVs(!0),this._syncAspect(),this._updateMaterial(),this._stopped=!1,this.markForUpdateRenderData()):this.resetSystem()},i._getTexture=function(){return this._renderSpriteFrame&&this._renderSpriteFrame.texture},i._updateMaterial=function(){var t=this.getMaterialInstance(0);t&&t.recompileShaders({USE_LOCAL:this._positionType!==J.FREE}),t&&t.passes.length>0&&this._updateBlendFunc()},i._finishedSimulation=function(){this.resetSystem(),this.stopSystem(),this.markForUpdateRenderData(),this.autoRemoveOnFinish&&this._stopped&&this.node.destroy()},i._canRender=function(){return t.prototype._canRender.call(this)&&!this._stopped&&null!==this._renderSpriteFrame&&void 0!==this._renderSpriteFrame},i._render=function(t){this._positionType===J.RELATIVE?t.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node.parent):this.positionType===J.GROUPED?t.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,this.node):t.commitComp(this,this._simulator.renderData,this._renderSpriteFrame,this._assembler,null)},i._updatePositionType=function(){this._positionType===J.RELATIVE?(this._renderEntity.setRenderTransform(this.node.parent),this._renderEntity.setUseLocal(!0)):this.positionType===J.GROUPED?(this._renderEntity.setRenderTransform(this.node),this._renderEntity.setUseLocal(!0)):(this._renderEntity.setRenderTransform(null),this._renderEntity.setUseLocal(!1))},y(e,[{key:"custom",get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,this._applyFile())}},{key:"file",get:function(){return this._file},set:function(t){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){this._renderSpriteFrame!==t&&(this._renderSpriteFrame=t,t&&!t._uuid||(this._spriteFrame=t),this._applySpriteFrame())}},{key:"particleCount",get:function(){return this._simulator.particles.length}},{key:"totalParticles",get:function(){return this._totalParticles},set:function(t){this._totalParticles!==t&&(this._totalParticles=t)}},{key:"startColor",get:function(){return this._startColor},set:function(t){this._startColor.r=t.r,this._startColor.g=t.g,this._startColor.b=t.b,this._startColor.a=t.a}},{key:"startColorVar",get:function(){return this._startColorVar},set:function(t){this._startColorVar.r=t.r,this._startColorVar.g=t.g,this._startColorVar.b=t.b,this._startColorVar.a=t.a}},{key:"color",get:function(){return this._color},set:function(){}},{key:"endColor",get:function(){return this._endColor},set:function(t){this._endColor.r=t.r,this._endColor.g=t.g,this._endColor.b=t.b,this._endColor.a=t.a}},{key:"endColorVar",get:function(){return this._endColorVar},set:function(t){this._endColorVar.r=t.r,this._endColorVar.g=t.g,this._endColorVar.b=t.b,this._endColorVar.a=t.a}},{key:"positionType",get:function(){return this._positionType},set:function(t){this._positionType=t,this._updateMaterial(),this._updatePositionType()}},{key:"preview",get:function(){return this._preview},set:function(t){t?this._startPreview():this._stopPreview(),this._preview=t}},{key:"stopped",get:function(){return this._stopped}},{key:"active",get:function(){return this._simulator.active}},{key:"assembler",get:function(){return this._assembler}}]),e}(B),$e.EmitterMode=Z,$e.PositionType=J,$e.DURATION_INFINITY=-1,$e.START_SIZE_EQUAL_TO_END_SIZE=-1,$e.START_RADIUS_EQUAL_TO_END_RADIUS=-1,o((he=tr).prototype,"custom",[S,ht,pt],Object.getOwnPropertyDescriptor(he.prototype,"custom"),he.prototype),o(he.prototype,"file",[ut,ct,dt],Object.getOwnPropertyDescriptor(he.prototype,"file"),he.prototype),o(he.prototype,"spriteFrame",[ft,mt],Object.getOwnPropertyDescriptor(he.prototype,"spriteFrame"),he.prototype),o(he.prototype,"totalParticles",[S,yt],Object.getOwnPropertyDescriptor(he.prototype,"totalParticles"),he.prototype),pe=o(he.prototype,"duration",[v,S,gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),ue=o(he.prototype,"emissionRate",[v,S,bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),ce=o(he.prototype,"life",[v,S,_t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),de=o(he.prototype,"lifeVar",[v,S,vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o(he.prototype,"startColor",[S,St],Object.getOwnPropertyDescriptor(he.prototype,"startColor"),he.prototype),o(he.prototype,"startColorVar",[S,wt],Object.getOwnPropertyDescriptor(he.prototype,"startColorVar"),he.prototype),o(he.prototype,"color",[Ct],Object.getOwnPropertyDescriptor(he.prototype,"color"),he.prototype),o(he.prototype,"endColor",[S,Ft],Object.getOwnPropertyDescriptor(he.prototype,"endColor"),he.prototype),o(he.prototype,"endColorVar",[S,Pt],Object.getOwnPropertyDescriptor(he.prototype,"endColorVar"),he.prototype),fe=o(he.prototype,"angle",[v,S,Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 90}}),me=o(he.prototype,"angleVar",[v,S,Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),ye=o(he.prototype,"startSize",[v,S,Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),ge=o(he.prototype,"startSizeVar",[v,S,At],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),be=o(he.prototype,"endSize",[v,S,xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_e=o(he.prototype,"endSizeVar",[v,S,Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ve=o(he.prototype,"startSpin",[v,S,It],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Se=o(he.prototype,"startSpinVar",[v,S,Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),we=o(he.prototype,"endSpin",[v,S,Et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ce=o(he.prototype,"endSpinVar",[v,S,zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fe=o(he.prototype,"sourcePos",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.ZERO.clone()}}),Pe=o(he.prototype,"posVar",[v,S,Mt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.ZERO.clone()}}),o(he.prototype,"positionType",[Ut,kt],Object.getOwnPropertyDescriptor(he.prototype,"positionType"),he.prototype),o(he.prototype,"preview",[S,Lt,Nt],Object.getOwnPropertyDescriptor(he.prototype,"preview"),he.prototype),De=o(he.prototype,"emitterMode",[v,S,Bt,Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z.GRAVITY}}),Te=o(he.prototype,"gravity",[v,S,jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.ZERO.clone()}}),Re=o(he.prototype,"speed",[v,S,Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 180}}),Ae=o(he.prototype,"speedVar",[v,S,Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),xe=o(he.prototype,"tangentialAccel",[v,S,Ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),Ve=o(he.prototype,"tangentialAccelVar",[v,S,qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ie=o(he.prototype,"radialAccel",[v,S,Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Oe=o(he.prototype,"radialAccelVar",[v,S,Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ee=o(he.prototype,"rotationIsDir",[v,S,Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ze=o(he.prototype,"startRadius",[v,S,Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Me=o(he.prototype,"startRadiusVar",[v,S,Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ue=o(he.prototype,"endRadius",[v,S,$t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ke=o(he.prototype,"endRadiusVar",[v,S,te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Le=o(he.prototype,"rotatePerS",[v,S,ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ne=o(he.prototype,"rotatePerSVar",[v,S,re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Be=o(he.prototype,"playOnLoad",[v,S,ie,ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ge=o(he.prototype,"autoRemoveOnFinish",[v,S,ne,se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),je=o(he.prototype,"_preview",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),We=o(he.prototype,"_custom",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ye=o(he.prototype,"_file",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),He=o(he.prototype,"_spriteFrame",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qe=o(he.prototype,"_totalParticles",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),Xe=o(he.prototype,"_startColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(255,255,255,255)}}),Ze=o(he.prototype,"_startColorVar",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(0,0,0,0)}}),Je=o(he.prototype,"_endColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(255,255,255,0)}}),Ke=o(he.prototype,"_endColorVar",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new U(0,0,0,0)}}),Qe=o(he.prototype,"_positionType",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return J.FREE}}),le=he))||le)||le)||le)||le)),Cr=function(){function t(t,e){this.point=new M,this.dir=new M,this.distance=0,this.time=0,t&&this.point.set(t),e&&this.dir.set(e)}var e=t.prototype;return e.setPoint=function(t,e){this.point.x=t,this.point.y=e},e.setDir=function(t,e){this.dir.x=t,this.dir.y=e},t}(),Fr=t("MotionStreak",(or=b("cc.MotionStreak"),lr=A(),hr=z(),pr=w(E),or(ur=F(ur=C(ur=lr(ur=hr((vr=_r=function(t){function e(){for(var e,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i))||this,h(e,"_preview",dr,p(e)),h(e,"_fadeTime",fr,p(e)),h(e,"_minSeg",mr,p(e)),h(e,"_stroke",yr,p(e)),h(e,"_texture",gr,p(e)),h(e,"_fastMode",br,p(e)),e._points=[],e}r(e,t);var i=e.prototype;return i.onEnable=function(){t.prototype.onEnable.call(this),this.reset()},i._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this._assembler=t),this.renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.renderData.material=this.material,this._updateColor())},i.onFocusInEditor=function(){this._preview&&this.reset()},i.onLostFocusInEditor=function(){this._preview&&this.reset()},i.reset=function(){this._points.length=0,this.renderData&&this.renderData.clear()},i.lateUpdate=function(t){this._assembler&&this._assembler.update(this,t)},i._render=function(t){t.commitComp(this,this.renderData,this._texture,this._assembler,null)},y(e,[{key:"preview",get:function(){return this._preview},set:function(t){this._preview=t,this.reset()}},{key:"fadeTime",get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this.reset()}},{key:"minSeg",get:function(){return this._minSeg},set:function(t){this._minSeg=t}},{key:"stroke",get:function(){return this._stroke},set:function(t){this._stroke=t}},{key:"texture",get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t)}},{key:"fastMode",get:function(){return this._fastMode},set:function(t){this._fastMode=t}},{key:"points",get:function(){return this._points}}]),e}(B),_r.Point=Cr,o((cr=vr).prototype,"preview",[S],Object.getOwnPropertyDescriptor(cr.prototype,"preview"),cr.prototype),o(cr.prototype,"fadeTime",[S],Object.getOwnPropertyDescriptor(cr.prototype,"fadeTime"),cr.prototype),o(cr.prototype,"minSeg",[S],Object.getOwnPropertyDescriptor(cr.prototype,"minSeg"),cr.prototype),o(cr.prototype,"stroke",[S],Object.getOwnPropertyDescriptor(cr.prototype,"stroke"),cr.prototype),o(cr.prototype,"texture",[pr],Object.getOwnPropertyDescriptor(cr.prototype,"texture"),cr.prototype),o(cr.prototype,"fastMode",[S],Object.getOwnPropertyDescriptor(cr.prototype,"fastMode"),cr.prototype),dr=o(cr.prototype,"_preview",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fr=o(cr.prototype,"_fadeTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),mr=o(cr.prototype,"_minSeg",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),yr=o(cr.prototype,"_stroke",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 64}}),gr=o(cr.prototype,"_texture",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),br=o(cr.prototype,"_fastMode",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ur=cr))||ur)||ur)||ur)||ur)||ur)),Pr=(new M,new M),Dr=new M;function Tr(t,e){return t.x=-e.y,t.y=e.x,t}var Rr={createData:function(t){var e=t.requestRenderData();return e.dataLength=4,e.resize(16,42),e},update:function(t,e){var r,i=t.stroke/2,a=t.node.worldMatrix,n=a.m12,s=a.m13,o=t.points;if(o.length>1){var l=o[0],h=l.point.x-n,p=l.point.y-s;h*h+p*p<t.minSeg&&(r=l)}r||(r=new Fr.Point,o.unshift(r)),r.setPoint(n,s),r.time=t.fadeTime+e;var u,c=0;if(!(o.length<2)){var d=t.renderData;this.updateRenderDataCache(t,d);var f=t.color,m=f.r,y=f.g,g=f.b,b=f.a,_=o[1];_.distance=M.subtract(Dr,r.point,_.point).length(),Dr.normalize(),_.setDir(Dr.x,Dr.y),r.setDir(Dr.x,Dr.y),d.dataLength=2*o.length;for(var v=d.data,S=t.fadeTime,w=!1,C=o.length-1;C>=0;C--){var F=o[C],P=F.point,D=F.dir;if(F.time-=e,F.time<0)o.splice(C,1);else{var T=F.time/S,R=o[C-1];if(!w){if(!R){o.splice(C,1);continue}P.x=R.point.x-D.x*T,P.y=R.point.y-D.y*T}w=!0,Tr(Pr,D);var A=(T*b<<24>>>0)+(g<<16)+(y<<8)+m,x=c;v[x].x=P.x+Pr.x*i,v[x].y=P.y+Pr.y*i,v[x].u=1,v[x].v=T,v[x].color._val=A,v[x+=1].x=P.x-Pr.x*i,v[x].y=P.y-Pr.y*i,v[x].u=0,v[x].v=T,v[x].color._val=A,c+=2}}u=c<=2?0:3*(c-2),d.resize(c,u)}},updateWorldVertexAllData:function(t){for(var e=t.renderData,r=e.floatStride,i=e.data,a=e.chunk.vb,n=0;n<i.length;n++){var s=n*r;a[s+0]=i[n].x,a[s+1]=i[n].y,a[s+2]=i[n].z,a[s+3]=i[n].u,a[s+4]=i[n].v,U.toArray(a,i[n].color,s+5)}},createQuadIndices:function(t,e){var r=t.renderData.chunk.meshBuffer.indexOffset;Sr=null,Sr=new Uint16Array(e);for(var i=0,a=e;i<a;i+=2){var n=0+i;Sr[r++]=n,Sr[r++]=n+2,Sr[r++]=n+1,Sr[r++]=n+1,Sr[r++]=n+2,Sr[r++]=n+3}},updateRenderDataCache:function(t,e){e.passDirty&&e.updatePass(t),e.nodeDirty&&e.updateNode(t),e.textureDirty&&t.texture&&(e.updateTexture(t.texture),e.material=t.getRenderMaterial(0)),e.hashDirty&&e.updateHash()},updateRenderData:function(){},updateColor:function(){},fillBuffers:function(t){for(var e=t.renderData,r=e.chunk,i=e.data,a=e.vertexCount,n=e.indexCount,s=r.vb,o=0,l=0;l<a;l++){var h=i[l];s[o++]=h.x,s[o++]=h.y,s[o++]=h.z,s[o++]=h.u,s[o++]=h.v,U.toArray(s,h.color,o),o+=4}r.bufferId;for(var p=r.vertexOffset,u=r.meshBuffer,c=r.meshBuffer.iData,d=u.indexOffset,f=0,m=n;f<m;f+=2){var y=p+f;c[d++]=y,c[d++]=y+2,c[d++]=y+1,c[d++]=y+1,c[d++]=y+2,c[d++]=y+3}u.indexOffset+=e.indexCount,u.setDirty()}},Ar=t("MotionStreakAssemblerManager",{getAssembler:function(){return Rr}});Fr.Assembler=Ar;var xr={maxParticleDeltaTime:0,createData:function(){return G.add()},removeData:function(t){G.remove(t)},updateRenderData:function(){},fillBuffers:function(){}},Vr=t("ParticleSystem2DAssembler",{getAssembler:function(){return xr.maxParticleDeltaTime||(xr.maxParticleDeltaTime=l.game.frameTime/1e3*2),xr}});wr.Assembler=Vr}}}));
