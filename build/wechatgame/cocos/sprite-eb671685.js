System.register(["./bits-b8bc8b22.js","./buffer-barrier-17698e09.js","./scene-asset-10397f71.js","./math-base-02e87bf8.js","./index-f2c2eec3.js","./pipeline-state-manager-f4a950fe.js","./deprecated-dacf9914.js","./sprite-renderer-e42860e7.js","./ui-renderer-09c699a1.js"],(function(t){"use strict";var e,i,r,n,a,s,o,l,h,u,p,c,f,_,y,d,g,m,b,D,v,F,A,T,x,w,S,E,R,O,z,M,I,U,P,C,k,L,H,j,B,N,V,W,G,X;return{setters:[function(t){e=t.F,i=t.K,r=t.a3,n=t.G,a=t.l,s=t.H,o=t.I,l=t.A,h=t.w,u=t.ag,p=t.a0,c=t.y,f=t.d,_=t.m,y=t.ac},function(t){d=t.a6},function(t){g=t.a$,m=t.a2,b=t.b1,D=t.b7,v=t.b_,F=t.cc,A=t.e,T=t.b0,x=t.bY,w=t.aa,S=t.a9,E=t.c0,R=t.cd,O=t.bT,z=t.bX,M=t.bU,I=t.b5,U=t.bP,P=t.b2,C=t.ae,k=t.ad,L=t.bQ},function(t){H=t.C,j=t.i,B=t.V},function(){},function(){},function(t){N=t.k,V=t.j},function(t){W=t.S},function(t){G=t.I,X=t.U}],execute:function(){var Y,Z,$,K;t({H:void 0,O:void 0,V:void 0,b:void 0,e:function(t){var e=t.charCodeAt(0);return e>=9&&e<=13||32===e||133===e||160===e||5760===e||e>=8192&&e<=8202||8232===e||8233===e||8239===e||8287===e||12288===e},f:function(t){return Et.test(t)},g:function(){return 0},h:function(t){return St.test(t)},i:function(t){return/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/.test(t)||/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g.test(t)||/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/.test(t)},j:function(t){return Et.exec(t)},k:function(t){return St.exec(t)},l:function(t,e,i,r){var n=[];if(0===t.length||i<0)return n.push(""),n;for(var a=t;e>i&&a.length>1;){for(var s=a.length*(i/e)|0,o=Ot(a,s),l=e-r(o),h=o,u=0,p=0;l>i&&p++<100;)s*=i/l,l=e-r(o=Ot(a,s|=0));for(p=0;o&&l<=i&&p++<100;){var c=Tt.exec(o);h=o,l=e-r(o=Ot(a,s+=u=c?c[0].length:1))}0==(s-=u)?(s=1,h=Ot(a,1)):1===s&&a[0]>="\ud800"&&a[0]<="\udbff"&&(s=2,h=Ot(a,2));var f=Ot(a,0,s),_=void 0;xt.test(h||o)&&(0==(s-=(_=wt.exec(f))?_[0].length:0)&&(s=1),h=Ot(a,s),f=Ot(a,0,s)),Et.test(h)&&(_=St.exec(f))&&f!==_[0]&&(h=Ot(a,s-=_[0].length),f=Ot(a,0,s)),(0===n.length||(f=f.trim()).length>0)&&n.push(f),e=r(a=h||o)}return(0===n.length||(a=a.trim()).length>0)&&n.push(a),n},p:function(t){var e=t.color.toHEX(),i="";return t.isOutlined&&t.margin>0&&(i=i+t.margin+t.out.toHEX()),""+t.fontSize+t.fontFamily+e+i},s:Rt});var J,Q=t("S",g("cc.SpriteAtlas")((K=function(t){function n(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r))||this,s(e,"spriteFrames",$,o(e)),e}e(n,t);var a=n.prototype;return a.getTexture=function(){var t=Object.keys(this.spriteFrames);if(t.length>0){var e=this.spriteFrames[t[0]];return e&&e.texture}return null},a.getSpriteFrame=function(t){var e=this.spriteFrames[t];return e?(e.name||(e.name=t),e):null},a.getSpriteFrames=function(){for(var t=[],e=this.spriteFrames,i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t.push(e[n])}return t},a._serialize=function(){},a._deserialize=function(t,e){var n=t;this._name=n.name;var a=n.spriteFrames;this.spriteFrames=i();for(var s=0;s<a.length;s+=2)e.result.push(this.spriteFrames,a[s],a[s+1],r(W))},n}(m),$=n((Z=K).prototype,"spriteFrames",[b,D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return i()}}),Y=Z))||Y);a.SpriteAtlas=Q;var q,tt,et,it,rt=t("F",g("cc.Font")(J=function(t){function i(){return t.apply(this,arguments)||this}return e(i,t),i}(m))||J);a.Font=rt;var nt,at,st,ot,lt,ht,ut,pt,ct,ft=t("T",g("cc.TTFFont")((it=function(t){function i(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r))||this,s(e,"_fontFamily",et,o(e)),e}return e(i,t),i.prototype.initDefault=function(e){this._fontFamily="Arial",t.prototype.initDefault.call(this,e)},l(i,[{key:"_nativeAsset",get:function(){return this._fontFamily},set:function(t){this._fontFamily=t||"Arial"}},{key:"_nativeDep",get:function(){return{uuid:this._uuid,__nativeName__:this._native,ext:A(this._native),__isNative__:!0}}}]),i}(rt),et=n((tt=it).prototype,"_fontFamily",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n(tt.prototype,"_nativeAsset",[v,F],Object.getOwnPropertyDescriptor(tt.prototype,"_nativeAsset"),tt.prototype),n(tt.prototype,"_nativeDep",[v],Object.getOwnPropertyDescriptor(tt.prototype,"_nativeDep"),tt.prototype),q=tt))||q);a.TTFFont=ft;var _t,yt=function(){this.u=0,this.v=0,this.w=0,this.h=0,this.offsetX=0,this.offsetY=0,this.textureID=0,this.valid=!1,this.xAdvance=0},dt=t("o",function(){function t(t){this.letterDefinitions={},this.texture=t}var e=t.prototype;return e.addLetterDefinitions=function(t,e){this.letterDefinitions[t]=e},e.cloneLetterDefinition=function(){for(var t={},e=0,i=Object.keys(this.letterDefinitions);e<i.length;e++){var r=i[e],n=new yt;u(n,this.letterDefinitions[r]),t[r]=n}return t},e.getTexture=function(){return this.texture},e.getLetter=function(t){return this.letterDefinitions[t]},e.getLetterDefinitionForChar=function(t){var e=t.charCodeAt(0);return this.letterDefinitions.hasOwnProperty(e)?this.letterDefinitions[e]:null},e.clear=function(){this.letterDefinitions={}},t}()),gt=t("B",(nt=g("cc.BitmapFont"),at=T(W),nt((ct=function(t){function i(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r))||this,s(e,"fntDataStr",lt,o(e)),s(e,"spriteFrame",ht,o(e)),s(e,"fontSize",ut,o(e)),s(e,"fntConfig",pt,o(e)),e}return e(i,t),i.prototype.onLoaded=function(){var t=this.spriteFrame;!this.fontDefDictionary&&t&&(this.fontDefDictionary=new dt(t.texture));var e=this.fntConfig;if(e){var i=e.fontDefDictionary;for(var r in i){var n=new yt,a=i[r].rect;n.offsetX=i[r].xOffset,n.offsetY=i[r].yOffset,n.w=a.width,n.h=a.height,n.u=a.x,n.v=a.y,n.textureID=0,n.valid=!0,n.xAdvance=i[r].xAdvance,this.fontDefDictionary.addLetterDefinitions(r,n)}}else h("The fnt config is not exists!")},i}(rt),lt=n((ot=ct).prototype,"fntDataStr",[b,D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ht=n(ot.prototype,"spriteFrame",[at],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ut=n(ot.prototype,"fontSize",[b,D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),pt=n(ot.prototype,"fntConfig",[b,D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=ot))||st));a.BitmapFont=gt;var mt=t("L",g("cc.LabelAtlas")(_t=function(t){function i(){return t.apply(this,arguments)||this}return e(i,t),i}(gt))||_t);a.LabelAtlas=mt;var bt=t("d",.26),Dt=t("M",(bt+1)/2-bt);var vt=new p(2);vt.get=function(){return this._get()||{key:"",value:0,prev:null,next:null}};var Ft,At=new(function(){function t(t){this.count=0,this.limit=0,this.datas={},this.limit=t}var e=t.prototype;return e.moveToHead=function(t){t.next=this.head,t.prev=null,this.head&&(this.head.prev=t),this.head=t,this.tail||(this.tail=t),this.count++,this.datas[t.key]=t},e.put=function(t,e){var i=vt.get();if(i.key=t,i.value=e,this.count>=this.limit){var r=this.tail;delete this.datas[r.key],this.count--,this.tail=r.prev,this.tail.next=null,r.prev=null,r.next=null,vt.put(r)}this.moveToHead(i)},e.remove=function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,delete this.datas[t.key],this.count--},e.get=function(t){var e=this.datas[t];return e?(this.remove(e),this.moveToHead(e),e.value):null},e.clear=function(){this.count=0,this.datas={},this.head=null,this.tail=null},e.has=function(t){return!!this.datas[t]},e.delete=function(t){var e=this.datas[t];this.remove(e)},t}())(100),Tt=/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)/,xt=/^[!,.:;'}\]%\?>、‘“》？。，！]/,wt=/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]+|\S)$/,St=/[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]+$/,Et=/^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]/;function Rt(t,e,i){var r=(i||t.font)+"🎮"+e,n=At.get(r);if(null!==n)return n;var a=t.measureText(e),s=a&&a.width||0;return At.put(r,s),s}function Ot(t,e,i){var r=e,n=i,a=t[e];if(a>="\udc00"&&a<="\udfff"&&r--,void 0!==i)if(i-1!==e){var s=t[i-1];s>="\ud800"&&s<="\udbff"&&n--}else a>="\ud800"&&a<="\udbff"&&n++;return t.substring(r,n)}var zt,Mt,It,Ut,Pt,Ct,kt,Lt,Ht,jt,Bt,Nt,Vt,Wt,Gt,Xt,Yt,Zt,$t,Kt,Jt,Qt,qt,te,ee,ie,re,ne,ae,se,oe,le,he,ue,pe,ce,fe,_e,ye,de,ge,me,be,De,ve,Fe,Ae,Te,xe,we,Se,Ee,Re,Oe,ze,Me,Ie,Ue,Pe,Ce,ke,Le,He,je,Be,Ne,Ve,We,Ge,Xe,Ye=t("C",function(){function t(){this.pool=[]}t.getInstance=function(){return Ft||(Ft=new t),Ft};var e=t.prototype;return e.get=function(){var t=this.pool.pop();if(!t){var e=document.createElement("canvas"),i=e.getContext("2d");t={canvas:e,context:i}}return t},e.put=function(t){this.pool.length>=c.MAX_LABEL_CANVAS_POOL_SIZE||this.pool.push(t)},t}()),Ze=H.WHITE.clone(),$e=function(){this.u=0,this.v=0,this.w=0,this.h=0,this.texture=null,this.offsetX=0,this.offsetY=0,this.valid=!1,this.xAdvance=0},Ke="rgba(255, 255, 255, "+(1/255).toFixed(3)+")",Je=function(){function t(t,e){this.image=null,this.labelInfo=void 0,this.char=void 0,this.data=null,this.canvas=null,this.context=null,this.width=0,this.height=0,this.offsetY=0,this.hash=void 0,this.char=t,this.labelInfo=e,this.hash=t.charCodeAt(0)+e.hash}var e=t.prototype;return e.updateRenderData=function(){this._updateProperties(),this._updateTexture()},e.destroy=function(){this.image=null,Ye.getInstance().put(this.data)},e._updateProperties=function(){if(this.data=Ye.getInstance().get(),this.canvas=this.data.canvas,this.context=this.data.context,this.context){this.context.font=this.labelInfo.fontDesc;var t=Rt(this.context,this.char,this.labelInfo.fontDesc),e=2*this.labelInfo.margin+2;this.width=parseFloat(t.toFixed(2))+e,this.height=(1+bt)*this.labelInfo.fontSize+e,this.offsetY=-this.labelInfo.fontSize*bt/2}this.canvas.width!==this.width&&(this.canvas.width=this.width),this.canvas.height!==this.height&&(this.canvas.height=this.height),this.image||(this.image=new S),this.image.reset(this.canvas)},e._updateTexture=function(){if(this.context&&this.canvas){var t=this.context,e=this.labelInfo,i=this.canvas.width,r=this.canvas.height;t.textAlign="center",t.textBaseline="alphabetic",t.clearRect(0,0,i,r),t.fillStyle=Ke,t.fillRect(0,0,i,r),t.font=e.fontDesc;var n=e.fontSize,a=i/2,s=r/2+n*Dt+0*n,o=e.color;if(t.lineJoin="round",t.fillStyle="rgba("+o.r+", "+o.g+", "+o.b+", 1)",e.isOutlined){var l=e.out||Ze;t.strokeStyle="rgba("+l.r+", "+l.g+", "+l.b+", "+l.a/255+")",t.lineWidth=2*e.margin,t.strokeText(this.char,a,s)}t.fillText(this.char,a,s)}},t}(),Qe=function(t){function i(){return t.apply(this,arguments)||this}e(i,t);var r=i.prototype;return r.initWithSize=function(t,e,i){void 0===i&&(i=x.RGBA8888),this.reset({width:t,height:e,format:i})},r.drawTextureAt=function(t,e,i){var r=this.getGFXTexture();if(t&&r){var n=this._getGFXDevice();if(n){var a=new d;a.texOffset.x=e,a.texOffset.y=i,a.texExtent.width=t.width,a.texExtent.height=t.height,n.copyTexImagesToTexture([t.data],r,[a])}else console.warn("Unable to get device")}},i}(w);t("m",function(){function t(t,e){this._x=0,this._y=0,this._nextY=0,this._width=0,this._height=0,this._halfBleed=0,this._dirty=!1;var i=new Qe;i.initWithSize(t,e),this.fontDefDictionary=new dt(i),this._halfBleed=1,this._width=t,this._height=e,N.on(V.EVENT_BEFORE_SCENE_LAUNCH,this.beforeSceneLoad,this)}var e=t.prototype;return e.insertLetterTexture=function(t){var e=t.image,i=N.root.device;if(!e||!this.fontDefDictionary||!i)return null;var r=e.width,n=e.height;if(this._x+r+0>this._width&&(this._x=0,this._y=this._nextY),this._y+n>this._nextY&&(this._nextY=this._y+n+0),this._nextY>this._height)return f(12100),null;this.fontDefDictionary.texture.drawTextureAt(e,this._x,this._y),this._dirty=!0;var a=new $e;return a.u=this._x+this._halfBleed,a.v=this._y+this._halfBleed,a.texture=this.fontDefDictionary.texture,a.valid=!0,a.w=t.width-2,a.h=t.height-2,a.xAdvance=a.w,a.offsetY=t.offsetY,this._x+=r+0,this.fontDefDictionary.addLetterDefinitions(t.hash,a),a},e.update=function(){this._dirty&&(this._dirty=!1)},e.reset=function(){this._x=0,this._y=0,this._nextY=0,this.fontDefDictionary.clear()},e.destroy=function(){this.reset(),this.fontDefDictionary&&(this.fontDefDictionary.texture.destroy(),this.fontDefDictionary.texture=null)},e.getTexture=function(){return this.fontDefDictionary.getTexture()},e.beforeSceneLoad=function(){this.clearAllCache()},e.clearAllCache=function(){this.destroy();var t=new Qe;t.initWithSize(this._width,this._height),this.fontDefDictionary.texture=t},e.getLetter=function(t){return this.fontDefDictionary.letterDefinitions[t]},e.getLetterDefinitionForChar=function(t,e){var i=t.charCodeAt(0)+e.hash,r=this.fontDefDictionary.letterDefinitions[i];if(!r){var n=new Je(t,e);n.updateRenderData(),r=this.insertLetterTexture(n),n.destroy()}return r},l(t,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),t}()),t("n",{fontAtlas:null,fontSize:0,lineHeight:0,hAlign:0,vAlign:0,hash:"",fontFamily:"",fontDesc:"Arial",color:H.WHITE.clone(),isOutlined:!1,out:H.WHITE.clone(),margin:0}),H.WHITE.clone(),function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(Ve||(Ve=t("H",{}))),_(Ve),function(t){t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM"}(We||(We=t("V",{}))),_(We),function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.SHRINK=2]="SHRINK",t[t.RESIZE_HEIGHT=3]="RESIZE_HEIGHT"}(Ge||(Ge=t("O",{}))),_(Ge),function(t){t[t.NONE=0]="NONE",t[t.BITMAP=1]="BITMAP",t[t.CHAR=2]="CHAR"}(Xe||(Xe=t("b",{}))),_(Xe);var qe,ti,ei,ii,ri,ni,ai,si,oi,li,hi,ui,pi,ci,fi,_i,yi,di,gi,mi,bi,Di,vi,Fi,Ai,Ti,xi,wi,Si,Ei,Ri,Oi,zi,Mi,Ii,Ui,Pi,Ci,ki,Li,Hi,ji,Bi,Ni,Vi,Wi,Gi,Xi,Yi,Zi,$i=t("c",(zt=g("cc.Label"),Mt=O(),It=z(110),Ut=M(),Pt=I(),Ct=U(),kt=T(Ve),Lt=I(),Ht=U(),jt=T(We),Bt=I(),Nt=U(),Vt=I(),Wt=U(),Gt=I(),Xt=U(),Yt=P(),Zt=I(),$t=U(),Kt=T(Ge),Jt=I(),Qt=U(),qt=I(),te=U(),ee=I(),ie=U(),re=I(),ne=P(),ae=U(),se=T(rt),oe=I(),le=P(),he=U(),ue=T(Xe),pe=I(),ce=U(),fe=I(),_e=U(),ye=I(),de=U(),ge=I(),me=U(),be=P(),De=I(),ve=U(),zt(Fe=Mt(Fe=It(Fe=Ut((Ne=Be=function(t){function i(){var e;return e=t.call(this)||this,s(e,"_string",Te,o(e)),s(e,"_horizontalAlign",xe,o(e)),s(e,"_verticalAlign",we,o(e)),s(e,"_actualFontSize",Se,o(e)),s(e,"_fontSize",Ee,o(e)),s(e,"_fontFamily",Re,o(e)),s(e,"_lineHeight",Oe,o(e)),s(e,"_overflow",ze,o(e)),s(e,"_enableWrapText",Me,o(e)),s(e,"_font",Ie,o(e)),s(e,"_isSystemFontUsed",Ue,o(e)),s(e,"_spacingX",Pe,o(e)),s(e,"_isItalic",Ce,o(e)),s(e,"_isBold",ke,o(e)),s(e,"_isUnderline",Le,o(e)),s(e,"_underlineHeight",He,o(e)),s(e,"_cacheMode",je,o(e)),e._N$file=null,e._texture=null,e._ttfSpriteFrame=null,e._userDefinedFont=null,e._assemblerData=null,e._fontAtlas=null,e._letterTexture=null,e._contentWidth=0,e._ttfSpriteFrame=null,e}e(i,t);var r=i.prototype;return r.onEnable=function(){t.prototype.onEnable.call(this),this._font||this._isSystemFontUsed||(this.useSystemFont=!0),this._isSystemFontUsed&&!this._fontFamily&&(this.fontFamily="Arial"),this._applyFontTexture()},r.onDestroy=function(){if(this._assembler&&this._assembler.resetAssemblerData&&this._assembler.resetAssemblerData(this._assemblerData),this._assemblerData=null,this._ttfSpriteFrame){this._ttfSpriteFrame._resetDynamicAtlasFrame();var e=this._ttfSpriteFrame.texture;if(this._ttfSpriteFrame.destroy(),e){var i=e;i.image&&i.image.destroy(),e.destroy()}this._ttfSpriteFrame=null}this._letterTexture=null,t.prototype.onDestroy.call(this)},r.updateRenderData=function(t){void 0===t&&(t=!1),t&&(this._flushAssembler(),this.renderData&&(this.renderData.vertDirty=!0),this._applyFontTexture()),this._assembler&&this._assembler.updateRenderData(this)},r._render=function(t){t.commitComp(this,this.renderData,this._texture,this._assembler,null)},r._updateColor=function(){t.prototype._updateColor.call(this),this.markForUpdateRenderData()},r.setEntityColor=function(){},r._canRender=function(){if(!t.prototype._canRender.call(this)||!this._string)return!1;var e=this._font;if(e&&e instanceof gt){var i=e.spriteFrame;if(!i||!i.texture)return!1}return!0},r._flushAssembler=function(){var t=i.Assembler.getAssembler(this);this._assembler!==t&&(this.destroyRenderData(),this._assembler=t),this.renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.renderData.material=this.material,this._updateColor())},r._applyFontTexture=function(){this.markForUpdateRenderData();var t=this._font;if(t instanceof gt){var e=t.spriteFrame;e&&e.texture&&(this._texture=e,this.renderData&&(this.renderData.textureDirty=!0),this.changeMaterialForDefine(),this._assembler&&this._assembler.updateRenderData(this))}else{if(this.cacheMode===Xe.CHAR)this._letterTexture=this._assembler.getAssemblerData(),this._texture=this._letterTexture;else if(!this._ttfSpriteFrame){this._ttfSpriteFrame=new W,this._assemblerData=this._assembler.getAssemblerData();var i=new S(this._assemblerData.canvas),r=new w;r.image=i,this._ttfSpriteFrame.texture=r}this.cacheMode!==Xe.CHAR&&(this._texture=this._ttfSpriteFrame),this.changeMaterialForDefine()}},r.changeMaterialForDefine=function(){if(this._texture){var t=!1;if(this.cacheMode!==Xe.CHAR){var e=this._texture.texture;if(e instanceof E){var i=e.getPixelFormat();t=i===x.RGBA_ETC1||i===x.RGB_A_PVRTC_4BPPV1||i===x.RGB_A_PVRTC_2BPPV1}}this._instanceMaterialType=t?G.USE_ALPHA_SEPARATED:G.ADD_COLOR_AND_TEXTURE,this.updateMaterial()}},r._updateBlendFunc=function(){t.prototype._updateBlendFunc.call(this)},l(i,[{key:"string",get:function(){return this._string},set:function(t){t=null==t?"":t.toString(),this._string!==t&&(this._string=t,this.markForUpdateRenderData())}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!==t&&(this._horizontalAlign=t,this.markForUpdateRenderData())}},{key:"verticalAlign",get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!==t&&(this._verticalAlign=t,this.markForUpdateRenderData())}},{key:"actualFontSize",get:function(){return this._actualFontSize},set:function(t){this._actualFontSize=t}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.markForUpdateRenderData())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.markForUpdateRenderData())}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX!==t&&(this._spacingX=t,this.markForUpdateRenderData())}},{key:"overflow",get:function(){return this._overflow},set:function(t){this._overflow!==t&&(this._overflow=t,this.markForUpdateRenderData())}},{key:"enableWrapText",get:function(){return this._enableWrapText},set:function(t){this._enableWrapText!==t&&(this._enableWrapText=t,this.markForUpdateRenderData())}},{key:"useSystemFont",get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed!==t&&(this.destroyRenderData(),this._isSystemFontUsed=!!t,t&&(this.font=null),this._flushAssembler(),this.markForUpdateRenderData())}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this.markForUpdateRenderData())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._isSystemFontUsed=!t,this._font=t,this.destroyRenderData(),this._fontAtlas=null,this.updateRenderData(!0))}},{key:"cacheMode",get:function(){return this._cacheMode},set:function(t){this._cacheMode!==t&&(this._cacheMode!==Xe.BITMAP||this._font instanceof gt||!this._ttfSpriteFrame||this._ttfSpriteFrame._resetDynamicAtlasFrame(),this._cacheMode===Xe.CHAR&&(this._ttfSpriteFrame=null),this._cacheMode=t,this.updateRenderData(!0))}},{key:"isBold",get:function(){return this._isBold},set:function(t){this._isBold!==t&&(this._isBold=t,this.markForUpdateRenderData())}},{key:"isItalic",get:function(){return this._isItalic},set:function(t){this._isItalic!==t&&(this._isItalic=t,this.markForUpdateRenderData())}},{key:"isUnderline",get:function(){return this._isUnderline},set:function(t){this._isUnderline!==t&&(this._isUnderline=t,this.markForUpdateRenderData())}},{key:"underlineHeight",get:function(){return this._underlineHeight},set:function(t){this._underlineHeight!==t&&(this._underlineHeight=t,this.markForUpdateRenderData())}},{key:"spriteFrame",get:function(){return this._texture}},{key:"ttfSpriteFrame",get:function(){return this._ttfSpriteFrame}},{key:"assemblerData",get:function(){return this._assemblerData}},{key:"fontAtlas",get:function(){return this._fontAtlas},set:function(t){this._fontAtlas=t}},{key:"_bmFontOriginalSize",get:function(){return this._font instanceof gt?this._font.fontSize:-1}},{key:"contentWidth",get:function(){return this._contentWidth},set:function(t){this._contentWidth=t}}]),i}(X),Be.HorizontalAlign=Ve,Be.VerticalAlign=We,Be.Overflow=Ge,Be.CacheMode=Xe,Be._canvasPool=Ye.getInstance(),n((Ae=Ne).prototype,"string",[Pt,Ct,R],Object.getOwnPropertyDescriptor(Ae.prototype,"string"),Ae.prototype),n(Ae.prototype,"horizontalAlign",[kt,Lt,Ht],Object.getOwnPropertyDescriptor(Ae.prototype,"horizontalAlign"),Ae.prototype),n(Ae.prototype,"verticalAlign",[jt,Bt,Nt],Object.getOwnPropertyDescriptor(Ae.prototype,"verticalAlign"),Ae.prototype),n(Ae.prototype,"fontSize",[Vt,Wt],Object.getOwnPropertyDescriptor(Ae.prototype,"fontSize"),Ae.prototype),n(Ae.prototype,"lineHeight",[Gt,Xt],Object.getOwnPropertyDescriptor(Ae.prototype,"lineHeight"),Ae.prototype),n(Ae.prototype,"spacingX",[Yt,Zt,$t],Object.getOwnPropertyDescriptor(Ae.prototype,"spacingX"),Ae.prototype),n(Ae.prototype,"overflow",[Kt,Jt,Qt],Object.getOwnPropertyDescriptor(Ae.prototype,"overflow"),Ae.prototype),n(Ae.prototype,"enableWrapText",[qt,te],Object.getOwnPropertyDescriptor(Ae.prototype,"enableWrapText"),Ae.prototype),n(Ae.prototype,"useSystemFont",[ee,ie],Object.getOwnPropertyDescriptor(Ae.prototype,"useSystemFont"),Ae.prototype),n(Ae.prototype,"fontFamily",[re,ne,ae],Object.getOwnPropertyDescriptor(Ae.prototype,"fontFamily"),Ae.prototype),n(Ae.prototype,"font",[se,oe,le,he],Object.getOwnPropertyDescriptor(Ae.prototype,"font"),Ae.prototype),n(Ae.prototype,"cacheMode",[ue,pe,ce],Object.getOwnPropertyDescriptor(Ae.prototype,"cacheMode"),Ae.prototype),n(Ae.prototype,"isBold",[fe,_e],Object.getOwnPropertyDescriptor(Ae.prototype,"isBold"),Ae.prototype),n(Ae.prototype,"isItalic",[ye,de],Object.getOwnPropertyDescriptor(Ae.prototype,"isItalic"),Ae.prototype),n(Ae.prototype,"isUnderline",[ge,me],Object.getOwnPropertyDescriptor(Ae.prototype,"isUnderline"),Ae.prototype),n(Ae.prototype,"underlineHeight",[be,D,De,ve],Object.getOwnPropertyDescriptor(Ae.prototype,"underlineHeight"),Ae.prototype),Te=n(Ae.prototype,"_string",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"label"}}),xe=n(Ae.prototype,"_horizontalAlign",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ve.CENTER}}),we=n(Ae.prototype,"_verticalAlign",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return We.CENTER}}),Se=n(Ae.prototype,"_actualFontSize",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ee=n(Ae.prototype,"_fontSize",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Re=n(Ae.prototype,"_fontFamily",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Arial"}}),Oe=n(Ae.prototype,"_lineHeight",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),ze=n(Ae.prototype,"_overflow",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ge.NONE}}),Me=n(Ae.prototype,"_enableWrapText",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ie=n(Ae.prototype,"_font",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ue=n(Ae.prototype,"_isSystemFontUsed",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Pe=n(Ae.prototype,"_spacingX",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ce=n(Ae.prototype,"_isItalic",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ke=n(Ae.prototype,"_isBold",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Le=n(Ae.prototype,"_isUnderline",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),He=n(Ae.prototype,"_underlineHeight",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),je=n(Ae.prototype,"_cacheMode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xe.NONE}}),Fe=Ae))||Fe)||Fe)||Fe)||Fe));a.Label=$i,function(t){t[t.SIMPLE=0]="SIMPLE",t[t.SLICED=1]="SLICED",t[t.TILED=2]="TILED",t[t.FILLED=3]="FILLED"}(Gi||(Gi={})),_(Gi),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.RADIAL=2]="RADIAL"}(Xi||(Xi={})),_(Xi),function(t){t[t.CUSTOM=0]="CUSTOM",t[t.TRIMMED=1]="TRIMMED",t[t.RAW=2]="RAW"}(Yi||(Yi={})),_(Yi),function(t){t.SPRITE_FRAME_CHANGED="spriteframe-changed"}(Zi||(Zi={}));var Ki=t("a",(qe=g("cc.Sprite"),ti=O(),ei=z(110),ii=M(),ri=T(Q),ni=I(),ai=U(),si=T(W),oi=I(),li=U(),hi=T(Gi),ui=I(),pi=U(),ci=T(Xi),fi=I(),_i=U(),yi=I(),di=U(),gi=L(),mi=I(),bi=U(),Di=L(),vi=I(),Fi=U(),Ai=P(),Ti=I(),xi=U(),wi=I(),Si=U(),Ei=T(Yi),Ri=I(),Oi=U(),qe(zi=ti(zi=ei(zi=ii((Wi=Vi=function(t){function i(){for(var e,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r))||this,s(e,"_spriteFrame",Ii,o(e)),s(e,"_type",Ui,o(e)),s(e,"_fillType",Pi,o(e)),s(e,"_sizeMode",Ci,o(e)),s(e,"_fillCenter",ki,o(e)),s(e,"_fillStart",Li,o(e)),s(e,"_fillRange",Hi,o(e)),s(e,"_isTrimmedMode",ji,o(e)),s(e,"_useGrayscale",Bi,o(e)),s(e,"_atlas",Ni,o(e)),e}e(i,t);var r=i.prototype;return r.__preload=function(){this.changeMaterialForDefine(),t.prototype.__preload.call(this)},r.onEnable=function(){t.prototype.onEnable.call(this),this._activateMaterial();var e=this._spriteFrame;e&&(this._updateUVs(),this._type===Gi.SLICED&&e.on(W.EVENT_UV_UPDATED,this._updateUVs,this))},r.onDisable=function(){t.prototype.onDisable.call(this),this._spriteFrame&&this._type===Gi.SLICED&&this._spriteFrame.off(W.EVENT_UV_UPDATED,this._updateUVs,this)},r.onDestroy=function(){t.prototype.onDestroy.call(this)},r.changeSpriteFrameFromAtlas=function(t){if(this._atlas){var e=this._atlas.getSpriteFrame(t);this.spriteFrame=e}else console.warn("SpriteAtlas is null.")},r.changeMaterialForDefine=function(){var t,e=this._instanceMaterialType;this._spriteFrame&&(t=this._spriteFrame.texture);var i=!1;if(t instanceof E){var r=t.getPixelFormat();i=r===x.RGBA_ETC1||r===x.RGB_A_PVRTC_4BPPV1||r===x.RGB_A_PVRTC_2BPPV1}i&&this.grayscale?this._instanceMaterialType=G.USE_ALPHA_SEPARATED_AND_GRAY:i?this._instanceMaterialType=G.USE_ALPHA_SEPARATED:this.grayscale?this._instanceMaterialType=G.GRAYSCALE:this._instanceMaterialType=G.ADD_COLOR_AND_TEXTURE,e!==this._instanceMaterialType&&this.updateMaterial()},r._updateBuiltinMaterial=function(){var e=t.prototype._updateBuiltinMaterial.call(this);if(this.spriteFrame&&this.spriteFrame.texture instanceof C){var i=y({SAMPLE_FROM_RT:!0},e.passes[0].defines),r=new k;r.initialize({effectAsset:e.effectAsset,defines:i}),e=r}return e},r._render=function(t){t.commitComp(this,this.renderData,this._spriteFrame,this._assembler,null)},r._canRender=function(){if(!t.prototype._canRender.call(this))return!1;var e=this._spriteFrame;return!(!e||!e.texture)},r._flushAssembler=function(){var t=i.Assembler.getAssembler(this);this._assembler!==t&&(this.destroyRenderData(),this._assembler=t),this.renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.renderData.material=this.getRenderMaterial(0),this.markForUpdateRenderData(),this.spriteFrame&&this._assembler.updateUVs(this),this._updateColor()),this._spriteFrame&&(this._type===Gi.SLICED?this._spriteFrame.on(W.EVENT_UV_UPDATED,this._updateUVs,this):this._spriteFrame.off(W.EVENT_UV_UPDATED,this._updateUVs,this))},r._applySpriteSize=function(){if(this._spriteFrame)if(Yi.RAW===this._sizeMode){var t=this._spriteFrame.originalSize;this.node._uiProps.uiTransformComp.setContentSize(t)}else if(Yi.TRIMMED===this._sizeMode){var e=this._spriteFrame.rect;this.node._uiProps.uiTransformComp.setContentSize(e.width,e.height)}},r._resized=function(){},r._activateMaterial=function(){var t=this._spriteFrame,e=this.getRenderMaterial(0);t&&e&&this.markForUpdateRenderData(),this.renderData&&(this.renderData.material=e)},r._updateUVs=function(){this._assembler&&this._assembler.updateUVs(this)},r._applySpriteFrame=function(t){var e=this._spriteFrame;t&&this._type===Gi.SLICED&&t.off(W.EVENT_UV_UPDATED,this._updateUVs,this);var i=!1;e&&(t&&t.texture===e.texture||(i=!0),i&&(this.renderData&&(this.renderData.textureDirty=!0),this.changeMaterialForDefine()),this._applySpriteSize(),this._type===Gi.SLICED&&e.on(W.EVENT_UV_UPDATED,this._updateUVs,this))},l(i,[{key:"spriteAtlas",get:function(){return this._atlas},set:function(t){this._atlas!==t&&(this._atlas=t)}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){if(this._spriteFrame!==t){var e=this._spriteFrame;this._spriteFrame=t,this.markForUpdateRenderData(),this._applySpriteFrame(e)}}},{key:"type",get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this._flushAssembler())}},{key:"fillType",get:function(){return this._fillType},set:function(t){this._fillType!==t&&(t===Xi.RADIAL||this._fillType===Xi.RADIAL?this.destroyRenderData():this.renderData&&this.markForUpdateRenderData(!0)),this._fillType=t,this._flushAssembler()}},{key:"fillCenter",get:function(){return this._fillCenter},set:function(t){this._fillCenter.x=t.x,this._fillCenter.y=t.y,this._type===Gi.FILLED&&this.renderData&&this.markForUpdateRenderData()}},{key:"fillStart",get:function(){return this._fillStart},set:function(t){this._fillStart=j(t,0,1),this._type===Gi.FILLED&&this.renderData&&(this.markForUpdateRenderData(),this._updateUVs())}},{key:"fillRange",get:function(){return this._fillRange},set:function(t){this._fillRange=j(t,-1,1),this._type===Gi.FILLED&&this.renderData&&(this.markForUpdateRenderData(),this._updateUVs())}},{key:"trim",get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._type===Gi.SIMPLE&&this.renderData&&this.markForUpdateRenderData(!0))}},{key:"grayscale",get:function(){return this._useGrayscale},set:function(t){this._useGrayscale!==t&&(this._useGrayscale=t,this.changeMaterialForDefine(),this.updateMaterial())}},{key:"sizeMode",get:function(){return this._sizeMode},set:function(t){this._sizeMode!==t&&(this._sizeMode=t,t!==Yi.CUSTOM&&this._applySpriteSize())}}]),i}(X),Vi.FillType=Xi,Vi.Type=Gi,Vi.SizeMode=Yi,Vi.EventType=Zi,n((Mi=Wi).prototype,"spriteAtlas",[ri,ni,ai],Object.getOwnPropertyDescriptor(Mi.prototype,"spriteAtlas"),Mi.prototype),n(Mi.prototype,"spriteFrame",[si,oi,li],Object.getOwnPropertyDescriptor(Mi.prototype,"spriteFrame"),Mi.prototype),n(Mi.prototype,"type",[hi,ui,pi],Object.getOwnPropertyDescriptor(Mi.prototype,"type"),Mi.prototype),n(Mi.prototype,"fillType",[ci,fi,_i],Object.getOwnPropertyDescriptor(Mi.prototype,"fillType"),Mi.prototype),n(Mi.prototype,"fillCenter",[yi,di],Object.getOwnPropertyDescriptor(Mi.prototype,"fillCenter"),Mi.prototype),n(Mi.prototype,"fillStart",[gi,mi,bi],Object.getOwnPropertyDescriptor(Mi.prototype,"fillStart"),Mi.prototype),n(Mi.prototype,"fillRange",[Di,vi,Fi],Object.getOwnPropertyDescriptor(Mi.prototype,"fillRange"),Mi.prototype),n(Mi.prototype,"trim",[Ai,Ti,xi],Object.getOwnPropertyDescriptor(Mi.prototype,"trim"),Mi.prototype),n(Mi.prototype,"grayscale",[D,wi,Si],Object.getOwnPropertyDescriptor(Mi.prototype,"grayscale"),Mi.prototype),n(Mi.prototype,"sizeMode",[Ei,Ri,Oi],Object.getOwnPropertyDescriptor(Mi.prototype,"sizeMode"),Mi.prototype),Ii=n(Mi.prototype,"_spriteFrame",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ui=n(Mi.prototype,"_type",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Gi.SIMPLE}}),Pi=n(Mi.prototype,"_fillType",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Xi.HORIZONTAL}}),Ci=n(Mi.prototype,"_sizeMode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Yi.TRIMMED}}),ki=n(Mi.prototype,"_fillCenter",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new B(0,0)}}),Li=n(Mi.prototype,"_fillStart",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Hi=n(Mi.prototype,"_fillRange",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ji=n(Mi.prototype,"_isTrimmedMode",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Bi=n(Mi.prototype,"_useGrayscale",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ni=n(Mi.prototype,"_atlas",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zi=Mi))||zi)||zi)||zi)||zi));a.Sprite=Ki}}}));
