System.register(["./bits-b8bc8b22.js","./buffer-barrier-17698e09.js","./scene-asset-10397f71.js","./math-base-02e87bf8.js","./index-f2c2eec3.js","./pipeline-state-manager-f4a950fe.js","./deprecated-dacf9914.js","./sprite-renderer-e42860e7.js","./sprite-eb671685.js","./ui-renderer-09c699a1.js","./graphics-1a828c83.js"],(function(t){"use strict";var e,i,n,r,s,o,a,h,l,c,u,p,_,f,d,g,m,y,b,C,v,S,T,A,E,x,R,O,I,L,D,w,k,P,H,z,M,N,F,W,j,G,U,X,B,V,Q,Y,Z,q,$,J,K,tt,et,it,nt,rt,st,ot,at,ht,lt,ct;return{setters:[function(t){e=t.m,i=t.F,n=t.d,r=t.A,s=t.G,o=t.l,a=t.H,h=t.I,l=t.i,c=t.a0,u=t.au,p=t.M},function(t){_=t.bn},function(t){f=t.a$,d=t.b0,g=t.bS,m=t.au,y=t.bO,b=t.ch,C=t.bT,v=t.bX,S=t.bU,T=t.bP,A=t.b5,E=t.b2,x=t.bQ,R=t.aI,O=t.b1,I=t.cf,L=t.ao,D=t.cd,w=t.M,k=t.b_,P=t.ce,H=t.b7},function(t){z=t.e,M=t.V,N=t.C,F=t.a,W=t.i,j=t.L},function(){},function(t){G=t.e,U=t.c},function(t){X=t.J,B=t.k},function(){},function(t){V=t.a,Q=t.c,Y=t.H,Z=t.V,q=t.F,$=t.b,J=t.S,t.T,K=t.j,tt=t.k,et=t.l,it=t.d,nt=t.i,rt=t.e},function(t){st=t.c,ot=t.a,at=t.d,ht=t.e,lt=t.U},function(t){ct=t.G}],execute:function(){var ut,pt,_t,ft,dt,gt,mt,yt,bt,Ct,vt,St,Tt,At,Et,xt,Rt,Ot,It,Lt,Dt=new z,wt=new M,kt=new z,Pt=[];!function(t){t[t.GRAPHICS_RECT=0]="GRAPHICS_RECT",t[t.GRAPHICS_ELLIPSE=1]="GRAPHICS_ELLIPSE",t[t.GRAPHICS_STENCIL=2]="GRAPHICS_STENCIL",t[t.SPRITE_STENCIL=3]="SPRITE_STENCIL"}(Lt||(Lt={})),e(Lt);var Ht=t("M",(ut=f("cc.Mask"),pt=C(),_t=v(110),ft=S(),dt=d(Lt),gt=T(),mt=A(),yt=T(),bt=E(),Ct=E(),vt=x(),ut(St=pt(St=_t(St=ft(St=g((It=Ot=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,a(e,"_type",At,h(e)),a(e,"_inverted",Et,h(e)),a(e,"_segments",xt,h(e)),a(e,"_alphaThreshold",Rt,h(e)),e._sprite=null,e._graphics=null,e._stencilStage=st.DISABLED,e}i(e,t);var s=e.prototype;return s.onLoad=function(){this._changeRenderType()},s.onEnable=function(){this._changeRenderType(),this._updateGraphics(),this._enableRender(),this.node.on(m.ANCHOR_CHANGED,this._nodeStateChange,this),this.node.on(m.SIZE_CHANGED,this._nodeStateChange,this)},s.onRestore=function(){this._changeRenderType(),this._updateGraphics()},s.onDisable=function(){this._disableRender(),this.node.off(m.ANCHOR_CHANGED,this._nodeStateChange,this),this.node.off(m.SIZE_CHANGED,this._nodeStateChange,this)},s.onDestroy=function(){this._removeMaskNode()},s.isHit=function(t){var e=this.node._uiProps.uiTransformComp,i=e.contentSize,n=i.width,r=i.height,s=wt;this.node.getWorldMatrix(Dt),z.invert(kt,Dt),M.transformMat4(s,t,kt);var o=e.anchorPoint;s.x+=o.x*n,s.y+=o.y*r;var a=!1;if(this.type===Lt.GRAPHICS_RECT||this.type===Lt.GRAPHICS_STENCIL||this.type===Lt.SPRITE_STENCIL)a=s.x>=0&&s.y>=0&&s.x<=n&&s.y<=r;else if(this.type===Lt.GRAPHICS_ELLIPSE){var h=n/2,l=r/2,c=s.x-.5*n,u=s.y-.5*r;a=c*c/(h*h)+u*u/(l*l)<1}return this._inverted&&(a=!a),a},s._nodeStateChange=function(){this._updateGraphics()},s._changeRenderType=function(){this._type!==Lt.SPRITE_STENCIL?this._createGraphics():this._createSprite()},s._createSprite=function(){if(!this._sprite){var t=this._sprite=this.node.getComponent(V);if(!t){var e=this.node;t=this._sprite=e.addComponent(V)}t.color=N.WHITE.clone(),t.sizeMode=0}this._sprite.stencilStage=this.inverted?st.ENTER_LEVEL_INVERTED:st.ENTER_LEVEL,this._sprite.updateMaterial()},s._createGraphics=function(){if(!this._graphics){var t=this._graphics=this.node.getComponent(ct);if(!t){var e=this.node;t=this._graphics=e.addComponent(ct)}t.lineWidth=1;var i=N.WHITE.clone();i.a=0,t.fillColor=i}this._graphics.stencilStage=this.inverted?st.ENTER_LEVEL_INVERTED:st.ENTER_LEVEL},s._updateGraphics=function(){if(this._graphics&&(this._type===Lt.GRAPHICS_RECT||this._type===Lt.GRAPHICS_ELLIPSE)){var t=this.node._uiProps.uiTransformComp,e=this._graphics;e.clear();var i=t.contentSize,n=i.width,r=i.height,s=t.anchorPoint,o=-n*s.x,a=-r*s.y;if(this._type===Lt.GRAPHICS_RECT)e.rect(o,a,n,r);else if(this._type===Lt.GRAPHICS_ELLIPSE){for(var h=function(t,e,i){Pt.length=0;for(var n=2*Math.PI/i,r=0;r<i;++r)Pt.push(new F(e.x*Math.cos(n*r)+t.x,e.y*Math.sin(n*r)+t.y,0));return Pt}(new F(o+n/2,a+r/2,0),new F(n/2,r/2,0),this._segments),l=0;l<h.length;++l){var c=h[l];0===l?e.moveTo(c.x,c.y):e.lineTo(c.x,c.y)}e.close()}e.fill()}},s._enableRender=function(){this.subComp&&(this.subComp.enabled=!0)},s._disableRender=function(){this.subComp&&(this.subComp.stencilStage=st.DISABLED,this.subComp.updateMaterial(),this.node.activeInHierarchy&&(this.subComp.enabled=!1))},s._removeMaskNode=function(){this._sprite&&(this._sprite.destroy(),this._sprite=null),this._graphics&&(this._graphics.destroy(),this._graphics=null)},s.markForUpdateRenderData=function(t){void 0===t&&(t=!0),n(9007),this.subComp&&this.subComp.markForUpdateRenderData(t)},s.requestRenderData=function(){n(9007)},s.destroyRenderData=function(){n(9007)},s.updateRenderer=function(){n(9007),this.subComp&&this.subComp.updateRenderer()},s.fillBuffers=function(){n(9007)},s.postUpdateAssembler=function(){n(9007)},s.setNodeDirty=function(){n(9007),this.subComp&&this.subComp.setNodeDirty()},s.setTextureDirty=function(){n(9007),this.subComp&&this.subComp.setTextureDirty()},s.getMaterial=function(t){return n(9007),this.subComp?this.subComp.getMaterial(t):null},s.setMaterial=function(t,e){n(9007),this.subComp&&this.subComp.setMaterial(t,e)},s.getMaterialInstance=function(t){return n(9007),this.subComp?this.subComp.getMaterialInstance(t):null},s.setMaterialInstance=function(t,e){n(9007),this.subComp&&this.subComp.setMaterialInstance(t,e)},s.getRenderMaterial=function(t){return n(9007),this.subComp?this.subComp.getRenderMaterial(t):null},r(e,[{key:"type",get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this._type!==Lt.SPRITE_STENCIL?(this._sprite&&(this.node.removeComponent(V),this._sprite._destroyImmediate(),this._sprite=null),this._changeRenderType(),this._updateGraphics()):(this._graphics&&(this._graphics.clear(),this.node.removeComponent(ct),this._graphics._destroyImmediate(),this._graphics=null),this._changeRenderType()))}},{key:"inverted",get:function(){return this._inverted},set:function(t){this._inverted=t,this.subComp.stencilStage=this.inverted?st.ENTER_LEVEL_INVERTED:st.ENTER_LEVEL}},{key:"segments",get:function(){return this._segments},set:function(t){this._segments!==t&&(this._segments=W(t,3,1e4),this._updateGraphics())}},{key:"spriteFrame",get:function(){return this._sprite?this._sprite.spriteFrame:null},set:function(t){this._sprite?this._sprite.spriteFrame=t:console.error("please change type to sprite_stencil first")}},{key:"alphaThreshold",get:function(){return this._alphaThreshold},set:function(t){this._alphaThreshold!==t&&(this._alphaThreshold=t,this.type===Lt.SPRITE_STENCIL&&this._sprite&&this._sprite.getMaterialInstance(0).setProperty("alphaThreshold",this._alphaThreshold))}},{key:"subComp",get:function(){return this._graphics||this._sprite}},{key:"customMaterial",get:function(){return n(9007),this.subComp?this.subComp.customMaterial:null},set:function(t){n(9007),this.subComp&&(this.subComp.customMaterial=t)}},{key:"color",get:function(){return n(9007),this.subComp?this.subComp.color:null},set:function(t){n(9007),this.subComp&&t&&(this.subComp.color=t)}},{key:"sharedMaterial",get:function(){return n(9007),this.subComp?this.subComp.sharedMaterial:null}},{key:"sharedMaterials",get:function(){return n(9007),this.subComp?this.subComp.sharedMaterials:null},set:function(t){n(9007),this.subComp&&t&&(this.subComp.sharedMaterials=t)}},{key:"material",get:function(){return n(9007),this.subComp?this.subComp.material:null},set:function(t){n(9007),this.subComp&&(this.subComp.material=t)}},{key:"materials",get:function(){return n(9007),this.subComp?this.subComp.materials:[null]},set:function(t){n(9007),this.subComp&&(this.subComp.materials=t)}}]),e}(R),Ot.Type=Lt,s((Tt=It).prototype,"type",[dt,gt],Object.getOwnPropertyDescriptor(Tt.prototype,"type"),Tt.prototype),s(Tt.prototype,"inverted",[mt,yt],Object.getOwnPropertyDescriptor(Tt.prototype,"inverted"),Tt.prototype),s(Tt.prototype,"segments",[bt],Object.getOwnPropertyDescriptor(Tt.prototype,"segments"),Tt.prototype),s(Tt.prototype,"alphaThreshold",[Ct,vt,y],Object.getOwnPropertyDescriptor(Tt.prototype,"alphaThreshold"),Tt.prototype),At=s(Tt.prototype,"_type",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Lt.GRAPHICS_RECT}}),Et=s(Tt.prototype,"_inverted",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xt=s(Tt.prototype,"_segments",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 64}}),Rt=s(Tt.prototype,"_alphaThreshold",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),St=Tt))||St)||St)||St)||St)||St));b._maskComp=Ht,o.Mask=Ht;var zt,Mt,Nt,Ft,Wt,jt,Gt,Ut,Xt,Bt,Vt,Qt,Yt,Zt,qt,$t,Jt,Kt,te,ee,ie,ne,re,se,oe,ae,he,le,ce,ue,pe,_e,fe,de,ge,me,ye,be,Ce,ve,Se,Te,Ae,Ee,xe,Re,Oe,Ie,Le,De,we,ke=/^(click)(\s)*=|(param)(\s)*=/,Pe=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/,He=t("H",function(){function t(){this._specialSymbolArray=[],this._stack=[],this._resultObjectArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"])}var e=t.prototype;return e.parse=function(t){this._resultObjectArray.length=0,this._stack.length=0;for(var e=0,i=t.length;e<i;){var n=t.indexOf(">",e),r=-1;if(n>=0&&(r=t.lastIndexOf("<",n))<e-1&&(r=t.indexOf("<",n+1),n=t.indexOf(">",r+1)),r<0)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{var s=t.substring(e,r),o=t.substring(r+1,n);""===o&&(s=t.substring(e,n+1)),this._processResult(s),-1===n?n=r:"/"===t.charAt(r+1)?this._stack.pop():this._addToStack(o),e=n+1}}return this._resultObjectArray},e._attributeToObject=function(t){t=t.trim();var e={},i=/^(color|size)(\s)*=/.exec(t),n="",r=0,s="";if(i){if(n=i[0],""===(t=t.substring(n.length).trim()))return e;switch(r=t.indexOf(" "),n[0]){case"c":e.color=r>-1?t.substring(0,r).trim():t;break;case"s":e.size=parseInt(t)}return r>-1&&(s=t.substring(r+1).trim(),e.event=this._processEventHandler(s)),e}if((i=/^(br(\s)*\/)/.exec(t))&&i[0].length>0&&(n=i[0].trim()).startsWith("br")&&"/"===n[n.length-1])return e.isNewLine=!0,this._resultObjectArray.push({text:"",style:{isNewLine:!0}}),e;var o="",a=-1;if((i=/^(img(\s)*src(\s)*=[^>]+\/)/.exec(t))&&i[0].length>0&&(n=i[0].trim()).startsWith("img")&&"/"===n[n.length-1]){var h;i=Pe.exec(t);for(var l=!1;i;){var c=(n=(t=t.substring(t.indexOf(i[0]))).substr(0,i[0].length)).length;if(n=(n=n.replace(/[^a-zA-Z]/g,"").trim()).toLowerCase(),o=t.substring(c).trim(),a="src"===n?this.getRightQuotationIndex(o):-1,h=(r=o.indexOf(" ",a+1>=o.length?-1:a+1))>-1?o.substr(0,r):o,t=o.substring(r).trim(),h.endsWith("/")&&(h=h.slice(0,-1)),"src"===n){switch(h.charCodeAt(0)){case 34:case 39:l=!0,h=h.slice(1,-1)}e.isImage=!0,e.src=h}else if("height"===n)e.imageHeight=parseInt(h);else if("width"===n)e.imageWidth=parseInt(h);else if("align"===n){switch(h.charCodeAt(0)){case 34:case 39:h=h.slice(1,-1)}e.imageAlign=h.toLowerCase()}else"offset"===n?e.imageOffset=h:"click"===n&&(e.event=this._processEventHandler(n+"="+h));e.event&&"param"===n&&(e.event[n]=h.replace(/^"|"$/g,"")),i=Pe.exec(t)}return l&&e.isImage&&this._resultObjectArray.push({text:"",style:e}),{}}if(i=/^(outline(\s)*[^>]*)/.exec(t)){var u={color:"#ffffff",width:1};if(t=i[0].substring("outline".length).trim()){var p,_=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(i=_.exec(t);i;)n=(t=t.substring(t.indexOf(i[0]))).substr(0,i[0].length),p=(r=(o=t.substring(n.length).trim()).indexOf(" "))>-1?o.substr(0,r):o,n=(n=n.replace(/[^a-zA-Z]/g,"").trim()).toLowerCase(),t=o.substring(r).trim(),"click"===n?e.event=this._processEventHandler(n+"="+p):"color"===n?u.color=p:"width"===n&&(u.width=parseInt(p)),e.event&&"param"===n&&(e.event[n]=p.replace(/^"|"$/g,"")),i=_.exec(t)}e.outline=u}if((i=/^(on|u|b|i)(\s)*/.exec(t))&&i[0].length>0){switch(n=i[0],t=t.substring(n.length).trim(),n[0]){case"u":e.underline=!0;break;case"i":e.italic=!0;break;case"b":e.bold=!0}if(""===t)return e;e.event=this._processEventHandler(t)}return e},e.getRightQuotationIndex=function(t){var e=-1,i=-1,n=t.indexOf("'"),r=t.indexOf('"'),s=r>-1&&(r<n||-1===n);return n>-1&&(n<r||-1===r)?(e=n,i=t.indexOf("'",e+1>=t.length?-1:e+1)):s&&(e=r,i=t.indexOf('"',e+1>=t.length?-1:e+1)),i},e._processEventHandler=function(t){for(var e={},i=0,n=!1,r=ke.exec(t);r;){var s=r[0],o="";if(n=!1,'"'===(t=t.substring(s.length).trim()).charAt(0))(i=t.indexOf('"',1))>-1&&(o=t.substring(1,i).trim(),n=!0),i++;else if("'"===t.charAt(0))(i=t.indexOf("'",1))>-1&&(o=t.substring(1,i).trim(),n=!0),i++;else{var a=/(\S)+/.exec(t);i=(o=a?a[0]:"").length}n&&(e[s=s.substring(0,s.length-1).trim()]=o),t=t.substring(i).trim(),r=ke.exec(t)}return e},e._addToStack=function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},e._processResult=function(t){0!==t.length&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},e._escapeSpecialSymbol=function(t){for(var e,i=l(this._specialSymbolArray);!(e=i()).done;){var n=e.value,r=n[0],s=n[1];t=t.replace(r,s)}return t},t}()),ze=t("L",(zt=f("cc.LabelOutline"),Mt=C(),Nt=v(110),Ft=S(),Wt=I(Q),jt=T(),Gt=T(),zt(Ut=Mt(Ut=Nt(Ut=Ft(Ut=Wt(Ut=g((Qt=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,a(e,"_color",Bt,h(e)),a(e,"_width",Vt,h(e)),e}i(e,t);var n=e.prototype;return n.onEnable=function(){this._updateRenderData()},n.onDisable=function(){this._updateRenderData()},n._updateRenderData=function(){var t=this.node.getComponent(Q);t&&t.updateRenderData(!0)},r(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateRenderData())}},{key:"width",get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._updateRenderData())}}]),e}(R),Bt=s((Xt=Qt).prototype,"_color",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new N(0,0,0,255)}}),Vt=s(Xt.prototype,"_width",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),s(Xt.prototype,"color",[jt],Object.getOwnPropertyDescriptor(Xt.prototype,"color"),Xt.prototype),s(Xt.prototype,"width",[Gt],Object.getOwnPropertyDescriptor(Xt.prototype,"width"),Xt.prototype),Ut=Xt))||Ut)||Ut)||Ut)||Ut)||Ut)||Ut));o.LabelOutline=ze;var Me=new He,Ne="RICHTEXT_CHILD",Fe="RICHTEXT_Image_CHILD",We=new c((function(t){if(!o.isValid(t.node))return!1;var e=t.node.getComponent(ze);return e&&(e.width=0),!0}),20),je=new c((function(t){return o.isValid(t.node)}),10);function Ge(t){return{node:new L(t),comp:null,lineCount:0,styleIndex:0,imageOffset:"",clickParam:"",clickHandler:"",type:t}}function Ue(t,e){var i;t===Ne?i=We._get():t===Fe&&(i=je._get());var n=(i=i||Ge(t)).node;return n||(n=new L(t)),n.hideFlags|=_.Flags.DontSave|_.Flags.HideInHierarchy,t===Fe?(i.comp=n.getComponent(V)||n.addComponent(V),i.comp.spriteFrame=e,i.comp.type=V.Type.SLICED,i.comp.sizeMode=V.SizeMode.CUSTOM):(i.comp=n.getComponent(Q)||n.addComponent(Q),i.comp.string=e,i.comp.horizontalAlign=Y.LEFT,i.comp.verticalAlign=Z.TOP,i.comp.underlineHeight=2),n.setPosition(0,0,0),n._uiProps.uiTransformComp.setAnchorPoint(.5,.5),i.node=n,i.lineCount=0,i.styleIndex=0,i.imageOffset="",i.clickParam="",i.clickHandler="",i}var Xe,Be=t("R",(Yt=f("cc.RichText"),Zt=C(),qt=v(110),$t=S(),Jt=T(),Kt=d(Y),te=T(),ee=d(Z),ie=T(),ne=T(),re=T(),se=d(q),oe=T(),ae=T(),he=A(),le=d($),ce=T(),ue=T(),pe=T(),_e=d(J),fe=T(),de=T(),Yt(ge=Zt(ge=qt(ge=$t(ge=g((we=De=function(t){function e(){var e;return e=t.call(this)||this,a(e,"_lineHeight",ye,h(e)),a(e,"_string",be,h(e)),a(e,"_horizontalAlign",Ce,h(e)),a(e,"_verticalAlign",ve,h(e)),a(e,"_fontSize",Se,h(e)),a(e,"_maxWidth",Te,h(e)),a(e,"_fontFamily",Ae,h(e)),a(e,"_font",Ee,h(e)),a(e,"_isSystemFontUsed",xe,h(e)),a(e,"_userDefinedFont",Re,h(e)),a(e,"_cacheMode",Oe,h(e)),a(e,"_imageAtlas",Ie,h(e)),a(e,"_handleTouchEvent",Le,h(e)),e._textArray=[],e._segments=[],e._labelSegmentsCache=[],e._linesWidth=[],e._lineCount=1,e._labelWidth=0,e._labelHeight=0,e._layoutDirty=!0,e._lineOffsetX=0,e._updateRichTextStatus=void 0,e._labelChildrenNum=0,e._updateRichTextStatus=e._updateRichText,e}i(e,t);var s=e.prototype;return s.onLoad=function(){this.node.on(m.LAYER_CHANGED,this._applyLayer,this),this.node.on(m.ANCHOR_CHANGED,this._updateRichTextPosition,this)},s.onEnable=function(){this.handleTouchEvent&&this._addEventListeners(),this._updateRichText(),this._activateChildren(!0)},s.onDisable=function(){this.handleTouchEvent&&this._removeEventListeners(),this._activateChildren(!1)},s.onRestore=function(){},s.onDestroy=function(){for(var t,e=l(this._segments);!(t=e()).done;){var i=t.value;i.node.removeFromParent(),i.type===Ne?We.put(i):i.type===Fe&&je.put(i)}this.node.off(m.ANCHOR_CHANGED,this._updateRichTextPosition,this),this.node.off(m.LAYER_CHANGED,this._applyLayer,this)},s._addEventListeners=function(){this.node.on(m.TOUCH_END,this._onTouchEnded,this)},s._removeEventListeners=function(){this.node.off(m.TOUCH_END,this._onTouchEnded,this)},s._updateLabelSegmentTextAttributes=function(){var t=this;this._segments.forEach((function(e){t._applyTextAttribute(e)}))},s._createFontLabel=function(t){return Ue(Ne,t)},s._createImage=function(t){return Ue(Fe,t)},s._onTTFLoaded=function(){this._font,this._layoutDirty=!0,this._updateRichText()},s.SplitLongStringApproximatelyIn2048=function(t,e){var i=[];if(this._calculateSize(e,t).x<2048)i.push(t);else for(var n=t.split("\n"),r=0;r<n.length;r++)if(this._calculateSize(e,n[r]).x<2048)i.push(n[r]);else{var s=this.splitLongStringOver2048(n[r],e);i.push.apply(i,s)}return i},s.splitLongStringOver2048=function(t,e){for(var i=[],n=t,r=0,s=n.length/2,o=n.substring(r,s),a=n.substring(s),h=this._calculateSize(e,o),l=(this._calculateSize(e,a),1*this.maxWidth);h.x>l;){if((s/=2)<1){s*=2;break}o=o.substring(r,s),a=n.substring(s),h=this._calculateSize(e,o)}for(var c=1e3,u=1;c&&r<t.length;){for(;c&&h.x<l;){var p=K(a);p&&p.length>0&&(u=p[0].length),s+=u,o=n.substring(r,s),a=n.substring(s),h=this._calculateSize(e,o),c--}for(;c&&o.length>=2&&h.x>l;)s-=u,o=n.substring(r,s),h=this._calculateSize(e,o),u=1,c--;if(o.length>=2){var _=tt(o);_&&_.length>0&&o!==_[0]&&(s-=_[0].length,o=n.substring(r,s))}if(i.push(o),r=s,s+=o.length,o=n.substring(r,s),a=n.substring(s),c--,this._calculateSize(e,a).x<2048){r=t.length,s=t.length,o=a,i.push(o);break}h=this._calculateSize(e,o)}return i},s._measureText=function(t,e){var i=this,n=function(e){return i._calculateSize(t,e).width};return e?n(e):n},s._calculateSize=function(t,e){var i;return 0===this._labelSegmentsCache.length?(i=this._createFontLabel(e),this._labelSegmentsCache.push(i)):(i=this._labelSegmentsCache[0]).node.getComponent(Q).string=e,i.styleIndex=t,this._applyTextAttribute(i),i.node._uiProps.uiTransformComp.contentSize},s._onTouchEnded=function(t){for(var e,i=this,n=this.node.getComponents(R),r=function(){var r=e.value,s=r.clickHandler,o=r.clickParam;s&&i._containsTouchLocation(r,t.touch.getUILocation())&&(n.forEach((function(e){var i=e[s];e.enabledInHierarchy&&i&&i.call(e,t,o)})),t.propagationStopped=!0)},s=l(this._segments);!(e=s()).done;)r()},s._containsTouchLocation=function(t,e){var i=t.node.getComponent(ot);return!!i&&i.getBoundingBoxToWorld().contains(e)},s._resetState=function(){for(var t=this.node.children,e=t.length-1;e>=0;e--){var i=t[e];if(i.name===Ne||i.name===Fe){i.parent=null;var n=Ge(i.name);n.node=i,i.name===Ne?(n.comp=i.getComponent(Q),We.put(n)):(n.comp=i.getComponent(V),je.put(n)),this._labelChildrenNum--}}this._segments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},s._activateChildren=function(t){for(var e=this.node.children.length-1;e>=0;e--){var i=this.node.children[e];i.name!==Ne&&i.name!==Fe||(i.active=t)}},s._addLabelSegment=function(t,e){var i;if(0===this._labelSegmentsCache.length)i=this._createFontLabel(t);else{var n=(i=this._labelSegmentsCache.pop()).node.getComponent(Q);n&&(n.string=t)}var r=i.comp;return r.verticalAlign!==this._verticalAlign&&(r.verticalAlign=this._verticalAlign),i.styleIndex=e,i.lineCount=this._lineCount,i.node._uiProps.uiTransformComp.setAnchorPoint(0,0),i.node.layer=this.node.layer,this.node.insertChild(i.node,this._labelChildrenNum++),this._applyTextAttribute(i),this._segments.push(i),i},s._updateRichTextWithMaxWidth=function(t,e,i){var n=e;if(this._lineOffsetX>0&&n+this._lineOffsetX>this._maxWidth)for(var r=0;this._lineOffsetX<=this._maxWidth;){var s=this._getFirstWordLen(t,r,t.length),o=t.substr(r,s),a=this._measureText(i,o);if(!(this._lineOffsetX+a<=this._maxWidth)){if(r>0){var h=t.substr(0,r);this._addLabelSegment(h,i),t=t.substr(r,t.length),n=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=a,r+=s}if(n>this._maxWidth)for(var l=et(t,n,this._maxWidth,this._measureText(i)),c=0;c<l.length;++c){var u=l[c],p=this._addLabelSegment(u,i).node._uiProps.uiTransformComp.contentSize;this._lineOffsetX+=p.width,l.length>1&&c<l.length-1&&this._updateLineInfo()}else this._lineOffsetX+=n,this._addLabelSegment(t,i)},s._isLastComponentCR=function(t){return t.length-1===t.lastIndexOf("\n")},s._updateLineInfo=function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},s._needsUpdateTextLayout=function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;e++){var i=this._textArray[e],n=t[e];if(i.text!==n.text)return!0;var r=i.style,s=n.style;if(r){if(s){if(!!s.outline!=!!r.outline)return!0;if(r.size!==s.size||r.italic!==s.italic||r.isImage!==s.isImage)return!0;if(r.src!==s.src||r.imageAlign!==s.imageAlign||r.imageHeight!==s.imageHeight||r.imageWidth!==s.imageWidth||r.imageOffset!==s.imageOffset)return!0}else if(r.size||r.italic||r.isImage||r.outline)return!0}else if(s&&(s.size||s.italic||s.isImage||s.outline))return!0}return!1},s._addRichTextImageElement=function(t){if(t.style){var e=t.style,i=e.src,r=this._imageAtlas&&i&&this._imageAtlas.getSpriteFrame(i);if(r){var s=this._createImage(r);switch(s.comp,e.imageAlign){case"top":s.node._uiProps.uiTransformComp.setAnchorPoint(0,1);break;case"center":s.node._uiProps.uiTransformComp.setAnchorPoint(0,.5);break;default:s.node._uiProps.uiTransformComp.setAnchorPoint(0,0)}e.imageOffset&&(s.imageOffset=e.imageOffset),s.node.layer=this.node.layer,this.node.insertChild(s.node,this._labelChildrenNum++),this._segments.push(s);var o=r.rect.clone(),a=1,h=o.width,l=o.height,c=e.imageWidth||0,u=e.imageHeight||0;u>0?(h*=a=u/l,l*=a):(h*=a=this._lineHeight/l,l*=a),c>0&&(h=c),this._maxWidth>0?(this._lineOffsetX+h>this._maxWidth&&this._updateLineInfo(),this._lineOffsetX+=h):(this._lineOffsetX+=h,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),s.node._uiProps.uiTransformComp.setContentSize(h,l),s.lineCount=this._lineCount,s.clickHandler="",s.clickParam="";var p=e.event;p&&(s.clickHandler=p.click,s.clickParam=p.param)}else n(4400)}},s._updateRichText=function(){if(this.enabledInHierarchy){var t=Me.parse(this._string);if(!this._needsUpdateTextLayout(t))return this._textArray=t.slice(),void this._updateLabelSegmentTextAttributes();this._textArray=t.slice(),this._resetState();for(var e,i=!1,n=0;n<this._textArray.length;++n){var r=this._textArray[n],s=r.text;if(void 0!==s){if(""===s){if(r.style&&r.style.isNewLine){this._updateLineInfo();continue}if(r.style&&r.style.isImage&&this._imageAtlas){this._addRichTextImageElement(r);continue}}for(var o=(s=this.SplitLongStringApproximatelyIn2048(s,n).join("\n")).split("\n"),a=0;a<o.length;++a){var h=o[a];if(""!==h)if(i=!1,this._maxWidth>0){var l=this._measureText(n,h);this._updateRichTextWithMaxWidth(h,l,n),o.length>1&&a<o.length-1&&this._updateLineInfo()}else e=this._addLabelSegment(h,n),this._lineOffsetX+=e.node._uiProps.uiTransformComp.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),o.length>1&&a<o.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(s)&&a===o.length-1)continue;this._updateLineInfo(),i=!0}}}}i||this._linesWidth.push(this._lineOffsetX),this._maxWidth>0&&(this._labelWidth=this._maxWidth),this._labelHeight=(this._lineCount+it)*this._lineHeight,this.node._uiProps.uiTransformComp.setContentSize(this._labelWidth,this._labelHeight),this._updateRichTextPosition(),this._layoutDirty=!1}},s._getFirstWordLen=function(t,e,i){var n=t.charAt(e);if(nt(n)||rt(n))return 1;for(var r=1,s=e+1;s<i&&(n=t.charAt(s),!rt(n)&&!nt(n));++s)r++;return r},s._updateRichTextPosition=function(){for(var t=0,e=1,i=this._lineCount,n=this.node._uiProps.uiTransformComp,r=n.anchorX,s=n.anchorY,o=0;o<this._segments.length;++o){var a=this._segments[o],h=a.lineCount;h>e&&(t=0,e=h);var l=this._labelWidth*(.5*this._horizontalAlign-r);switch(this._horizontalAlign){case Y.LEFT:break;case Y.CENTER:l-=this._linesWidth[h-1]/2;break;case Y.RIGHT:l-=this._linesWidth[h-1]}var c=a.node.position;if(a.node.setPosition(t+l,this._lineHeight*(i-h)-this._labelHeight*s,c.z),h===e&&(t+=a.node._uiProps.uiTransformComp.width),a.node.getComponent(V)){var u=a.node.position.clone(),p=this._lineHeight,_=this._lineHeight*(1+it);switch(a.node._uiProps.uiTransformComp.anchorY){case 1:u.y+=p+(_-p)/2;break;case.5:u.y+=_/2;break;default:u.y+=(_-p)/2}if(a.imageOffset){var f=a.imageOffset.split(",");if(1===f.length&&f[0]){var d=parseFloat(f[0]);Number.isInteger(d)&&(u.y+=d)}else if(2===f.length){var g=parseFloat(f[0]),m=parseFloat(f[1]);Number.isInteger(g)&&(u.x+=g),Number.isInteger(m)&&(u.y+=m)}}a.node.position=u}var y=a.node.getComponent(ze);if(y){var b=a.node.position.clone();b.y-=y.width,a.node.position=b}}},s._convertLiteralColorValue=function(t){var e=t.toUpperCase();return N[e]?N[e]:(new N).fromHEX(t)},s._applyTextAttribute=function(t){var e=t.node.getComponent(Q);if(e){this._resetLabelState(e);var i,n=t.styleIndex;if(this._textArray[n]&&(i=this._textArray[n].style),i){if(e.color=this._convertLiteralColorValue(i.color||"white"),e.isBold=!!i.bold,e.isItalic=!!i.italic,e.isUnderline=!!i.underline,i.outline){var r=t.node.getComponent(ze);r||(r=t.node.addComponent(ze)),r.color=this._convertLiteralColorValue(i.outline.color),r.width=i.outline.width}e.fontSize=i.size||this._fontSize,t.clickHandler="",t.clickParam="";var s=i.event;s&&(t.clickHandler=s.click||"",t.clickParam=s.param||"")}e.cacheMode=this._cacheMode,this._font instanceof q&&!this._isSystemFontUsed?e.font=this._font:e.fontFamily=this._fontFamily,e.useSystemFont=this._isSystemFontUsed,e.lineHeight=this._lineHeight,e.updateRenderData(!0)}},s._applyLayer=function(){for(var t,e=l(this._segments);!(t=e()).done;)t.value.node.layer=this.node.layer},s._resetLabelState=function(t){t.fontSize=this._fontSize,t.color=N.WHITE,t.isBold=!1,t.isItalic=!1,t.isUnderline=!1},r(e,[{key:"string",get:function(){return this._string},set:function(t){this._string!==t&&(this._string=t,this._updateRichTextStatus())}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this.horizontalAlign!==t&&(this._horizontalAlign=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"verticalAlign",get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!==t&&(this._verticalAlign=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._font=t,this._layoutDirty=!0,this._font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},{key:"useSystemFont",get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed!==t&&(this._isSystemFontUsed=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"cacheMode",get:function(){return this._cacheMode},set:function(t){this._cacheMode!==t&&(this._cacheMode=t,this._updateRichTextStatus())}},{key:"maxWidth",get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"imageAtlas",get:function(){return this._imageAtlas},set:function(t){this._imageAtlas!==t&&(this._imageAtlas=t,this._layoutDirty=!0,this._updateRichTextStatus())}},{key:"handleTouchEvent",get:function(){return this._handleTouchEvent},set:function(t){this._handleTouchEvent!==t&&(this._handleTouchEvent=t,this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners()))}}]),e}(R),De.HorizontalAlign=Y,De.VerticalAlign=Z,s((me=we).prototype,"string",[D,Jt],Object.getOwnPropertyDescriptor(me.prototype,"string"),me.prototype),s(me.prototype,"horizontalAlign",[Kt,te],Object.getOwnPropertyDescriptor(me.prototype,"horizontalAlign"),me.prototype),s(me.prototype,"verticalAlign",[ee,ie],Object.getOwnPropertyDescriptor(me.prototype,"verticalAlign"),me.prototype),s(me.prototype,"fontSize",[ne],Object.getOwnPropertyDescriptor(me.prototype,"fontSize"),me.prototype),s(me.prototype,"fontFamily",[re],Object.getOwnPropertyDescriptor(me.prototype,"fontFamily"),me.prototype),s(me.prototype,"font",[se,oe],Object.getOwnPropertyDescriptor(me.prototype,"font"),me.prototype),s(me.prototype,"useSystemFont",[ae,he],Object.getOwnPropertyDescriptor(me.prototype,"useSystemFont"),me.prototype),s(me.prototype,"cacheMode",[le,ce],Object.getOwnPropertyDescriptor(me.prototype,"cacheMode"),me.prototype),s(me.prototype,"maxWidth",[ue],Object.getOwnPropertyDescriptor(me.prototype,"maxWidth"),me.prototype),s(me.prototype,"lineHeight",[pe],Object.getOwnPropertyDescriptor(me.prototype,"lineHeight"),me.prototype),s(me.prototype,"imageAtlas",[_e,fe],Object.getOwnPropertyDescriptor(me.prototype,"imageAtlas"),me.prototype),s(me.prototype,"handleTouchEvent",[de],Object.getOwnPropertyDescriptor(me.prototype,"handleTouchEvent"),me.prototype),ye=s(me.prototype,"_lineHeight",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),be=s(me.prototype,"_string",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"<color=#00ff00>Rich</color><color=#0fffff>Text</color>"}}),Ce=s(me.prototype,"_horizontalAlign",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Y.LEFT}}),ve=s(me.prototype,"_verticalAlign",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z.TOP}}),Se=s(me.prototype,"_fontSize",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),Te=s(me.prototype,"_maxWidth",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ae=s(me.prototype,"_fontFamily",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Arial"}}),Ee=s(me.prototype,"_font",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=s(me.prototype,"_isSystemFontUsed",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Re=s(me.prototype,"_userDefinedFont",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oe=s(me.prototype,"_cacheMode",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return $.NONE}}),Ie=s(me.prototype,"_imageAtlas",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=s(me.prototype,"_handleTouchEvent",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ge=me))||ge)||ge)||ge)||ge)||ge));o.RichText=Be;var Ve=t("U",f("cc.UIMeshRenderer")(Xe=C()(Xe=v(110)(Xe=S()(Xe=g(Xe=function(t){function e(){var e;return(e=t.call(this)||this)._modelComponent=null,e.modelCount=0,e._dirtyVersion=-1,e._internalId=-1,e.stencilStage=st.DISABLED,e._renderData=null,e._renderEntity=new at(ht.DYNAMIC),e}i(e,t);var n=e.prototype;return n.__preload=function(){this.node._uiProps.uiComp=this},n.onEnable=function(){X.addRenderer(this),this.markForUpdateRenderData()},n.onDisable=function(){X.removeRenderer(this),this.renderEntity.enabled=this._canRender()},n.onLoad=function(){this.node._uiProps.uiTransformComp||this.node.addComponent("cc.UITransform"),this._modelComponent=this.getComponent("cc.ModelRenderer"),this._modelComponent?this.renderEntity.setNode(this.node):console.warn("node '"+(this.node&&this.node.name)+"' doesn't have any renderable component")},n.onDestroy=function(){this.renderEntity.setNode(null),this.node._uiProps.uiComp===this&&(this.node._uiProps.uiComp=null),this._modelComponent=this.getComponent("cc.ModelRenderer"),this._modelComponent&&(this._modelComponent._sceneGetter=null)},n._render=function(t){if(this._modelComponent){var e=this._modelComponent._collectModels();this._modelComponent._detachFromScene();for(var i=0;i<e.length;i++)e[i].enabled&&t.commitModel(this,e[i],this._modelComponent.material);return!0}return!1},n.fillBuffers=function(t){this.enabled&&this._render(t)},n.updateRenderer=function(){},n._uploadRenderData=function(){},n.postUpdateAssembler=function(){},n.update=function(){this._fitUIRenderQueue()},n._fitUIRenderQueue=function(){if(this._modelComponent)for(var t=this._modelComponent.sharedMaterials.length,e=0;e<t;e++){var i=this._modelComponent.getMaterialInstance(e);if(null!=i)for(var n=i.passes,r=n.length,s=0;s<r;s++)n[s]._priority=G.MAX-11,i.recompileShaders({CC_FORCE_FORWARD_SHADING:!0},s)}},n.markForUpdateRenderData=function(){X.markDirtyRenderer(this)},n.setNodeDirty=function(){},n.setTextureDirty=function(){},n._canRender=function(){return this.enabled&&null!==this._modelComponent},r(e,[{key:"modelComponent",get:function(){return this._modelComponent}},{key:"renderEntity",get:function(){return this._renderEntity}},{key:"renderData",get:function(){return this._renderData}}]),e}(R))||Xe)||Xe)||Xe)||Xe)||Xe);o.UIMeshRenderer=Ve;var Qe,Ye,Ze,qe,$e,Je,Ke,ti,ei,ii,ni,ri,si,oi,ai,hi,li,ci,ui,pi,_i,fi,di,gi,mi,yi,bi,Ci,vi,Si,Ti,Ai=U.Enum.NONE|U.Enum.UI_3D,Ei=t("D",function(){function t(){this.model=null,this.texture=null,this.sampler=null,this.useLocalData=null,this.isStatic=!1,this.textureHash=0,this.samplerHash=0,this._passes=[],this._shaders=[],this._visFlags=Ai,this._inputAssembler=null,this._descriptorSet=null}var e=t.prototype;return e.destroy=function(){this._passes=[]},e.clear=function(){this._inputAssembler=null,this._descriptorSet=null,this.texture=null,this.sampler=null,this.textureHash=0,this.samplerHash=0,this.model=null,this.isStatic=!1,this.useLocalData=null,this.visFlags=Ai},e.fillPasses=function(t,e,i,n){if(t){var r=t.passes;if(!r)return;this._shaders.length=r.length;for(var s=0;s<r.length;s++){this._passes[s]||(this._passes[s]=new w(o.director.root));var a=r[s],h=this._passes[s];a.update(),e||(e=a.depthStencilState,i=0),h._initPassFromTarget(a,e,i),this._shaders[s]=h.getShaderVariant(n)}}},r(t,[{key:"inputAssembler",get:function(){return this._inputAssembler},set:function(t){this._inputAssembler=t}},{key:"descriptorSet",get:function(){return this._descriptorSet},set:function(t){this._descriptorSet=t}},{key:"visFlags",get:function(){return this._visFlags},set:function(t){this._visFlags=t}},{key:"passes",get:function(){return this._passes}},{key:"shaders",get:function(){return this._shaders}}]),t}()),xi=t("a",(Qe=f("cc.UIStaticBatch"),Ye=C(),Ze=S(),qe=v(110),$e=E(),Qe(Je=Ye(Je=Ze(Je=qe((ti=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._init=!1,e._bufferAccessor=null,e._dirty=!0,e._uiDrawBatchList=[],e}i(e,t);var s=e.prototype;return s.postUpdateAssembler=function(){},s.markAsDirty=function(){},s._requireDrawBatch=function(){var t=new Ei;return t.isStatic=!0,this._uiDrawBatchList.push(t),t},s._clearData=function(){if(this._bufferAccessor){this._bufferAccessor.reset();for(var t=this._getBatcher(),e=0;e<this._uiDrawBatchList.length;e++)this._uiDrawBatchList[e].destroy(t)}this._uiDrawBatchList.length=0,this._init=!1},s._getBatcher=function(){return B.root&&B.root.batcher2D?B.root.batcher2D:(n(9301),null)},r(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&this._color.set(t)}},{key:"drawBatchList",get:function(){return this._uiDrawBatchList}}]),e}(lt),s((Ke=ti).prototype,"color",[k,$e],Object.getOwnPropertyDescriptor(Ke.prototype,"color"),Ke.prototype),Je=Ke))||Je)||Je)||Je)||Je)),Ri=(t("b",(ei=f("cc.LabelShadow"),ii=C(),ni=v(110),ri=S(),si=I(Q),oi=T(),ai=T(),hi=T(),ei(li=ii(li=ni(li=ri(li=si(li=g((fi=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,a(e,"_color",ui,h(e)),a(e,"_offset",pi,h(e)),a(e,"_blur",_i,h(e)),e}i(e,t);var n=e.prototype;return n.onEnable=function(){this._updateRenderData()},n.onDisable=function(){this._updateRenderData()},n._updateRenderData=function(){var t=this.node.getComponent(Q);t&&t.updateRenderData(!0)},r(e,[{key:"color",get:function(){return this._color},set:function(t){this._color!==t&&(this._color.set(t),this._updateRenderData())}},{key:"offset",get:function(){return this._offset},set:function(t){this._offset=t,this._updateRenderData()}},{key:"blur",get:function(){return this._blur},set:function(t){this._blur=t,this._updateRenderData()}}]),e}(R),ui=s((ci=fi).prototype,"_color",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new N(0,0,0,255)}}),pi=s(ci.prototype,"_offset",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(2,2)}}),_i=s(ci.prototype,"_blur",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),s(ci.prototype,"color",[oi],Object.getOwnPropertyDescriptor(ci.prototype,"color"),ci.prototype),s(ci.prototype,"offset",[ai],Object.getOwnPropertyDescriptor(ci.prototype,"offset"),ci.prototype),s(ci.prototype,"blur",[hi],Object.getOwnPropertyDescriptor(ci.prototype,"blur"),ci.prototype),li=ci))||li)||li)||li)||li)||li)||li)),t("c",(di=f("cc.UIOpacity"),gi=C(),mi=v(110),yi=S(),bi=T(),di(Ci=gi(Ci=mi(Ci=yi(Ci=g(Ci=P((Ti=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return e=t.call.apply(t,[this].concat(n))||this,a(e,"_opacity",Si,h(e)),e}i(e,t);var n=e.prototype;return n.setEntityLocalOpacityDirtyRecursively=function(){},e.setEntityLocalOpacityDirtyRecursively=function(t,i,n){if(t.isValid){var r=t._uiProps.uiComp,s=t.getComponent(e),o=n;r&&r.color?(r.renderEntity.colorDirty=i,r.renderEntity.localOpacity=s?o*s.opacity/255:o,o=1):s&&(o=o*s.opacity/255);for(var a=0;a<t.children.length;a++)e.setEntityLocalOpacityDirtyRecursively(t.children[a],i||o<1,o)}},n.onEnable=function(){this.node._uiProps.localOpacity=this._opacity/255,this.setEntityLocalOpacityDirtyRecursively(!0)},n.onDisable=function(){this.node._uiProps.localOpacity=1,this.setEntityLocalOpacityDirtyRecursively(!0)},r(e,[{key:"opacity",get:function(){return this._opacity},set:function(t){this._opacity!==t&&(t=u(t,0,255),this._opacity=t,this.node._uiProps.localOpacity=t/255,this.setEntityLocalOpacityDirtyRecursively(!0))}}]),e}(R),s((vi=Ti).prototype,"opacity",[H,bi],Object.getOwnPropertyDescriptor(vi.prototype,"opacity"),vi.prototype),Si=s(vi.prototype,"_opacity",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),Ci=vi))||Ci)||Ci)||Ci)||Ci)||Ci)||Ci)));o.MaskComponent=Ht,p.setClassAlias(Ht,"cc.MaskComponent"),o.LabelComponent=Q,p.setClassAlias(Q,"cc.LabelComponent"),o.LabelOutlineComponent=ze,p.setClassAlias(ze,"cc.LabelOutlineComponent"),o.RichTextComponent=Be,p.setClassAlias(Be,"cc.RichTextComponent"),o.SpriteComponent=V,p.setClassAlias(V,"cc.SpriteComponent"),o.UIModelComponent=Ve,p.setClassAlias(Ve,"cc.UIModelComponent"),o.GraphicsComponent=ct,p.setClassAlias(ct,"cc.GraphicsComponent"),p.setClassAlias(xi,"cc.UIStaticBatchComponent"),p.setClassAlias(Ri,"cc.UIOpacityComponent"),j(Ht.prototype,"Mask",[{name:"graphics",newName:"subComp",target:Ht.prototype,targetName:"Mask"}]),j(Lt,"MaskType",[{name:"RECT",newName:"GRAPHICS_RECT",target:Lt,targetName:"MaskType"},{name:"ELLIPSE",newName:"GRAPHICS_ELLIPSE",target:Lt,targetName:"MaskType"},{name:"IMAGE_STENCIL",newName:"SPRITE_STENCIL",target:Lt,targetName:"MaskType"}])}}}));
