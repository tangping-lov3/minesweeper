{"version":3,"sources":["../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Block.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/CIrcle.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Stores/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Stores/index.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Utils/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Utils/index.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Init.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Result/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Result/Mask.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Select/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Select/Option.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Overlay/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Overlay/Overlay.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Result/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Result/Result.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Select/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Select/Select.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/TopBar.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Utils/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Utils/vue.ts","../../file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/file:/Users/tonyptang/Desktop/cocos/Minesweeper/assets/Scripts/Wx.ts"],"names":["ccclass","_decorator","property","type","UITransform","Sprite","Button","Label","args","_this","__timer","__thunderCount","__colors","__status","ref","__isThunder","__originBlocks","__position","__thunderColors","__aroundBlockPos","__colorIndex","__thunderTextColors","__thunderStore","useThunder","_initializerDefineProperty","__clickLock","__debug","_inheritsLoose","_proto","__bindReactive","reactivity","this","nv","_this2","color","Color","fromHEX","__reset","value","Text","string","Circle","node","active","clearTimeout","start","on","Input","EventType","TOUCH_START","e","emitter","emit","getComponent","clickEvents","push","createEventHandler","target","component","handler","longpress","_this3","__mark","__computeAroundThunderCount","toString","__digThunder","__init","UI","__updateInfo","colorIndex","width","height","setContentSize","__updateCircleSize","size","ui","Widget","left","right","top","bottom","onClick","end","__dig","force","flat","forEach","block","__digAround","digedCount","__isWin","totalCount","thunderCount","__showCircle","Math","floor","random","length","show","x","y","_this$__originBlocks$","flagCount","_this$__originBlocks$2","Component","configurable","enumerable","writable","initializer","reset","option","EventHandler","key","arr","reduce","prev","cur","concat","path","Promise","resolve","reject","resources","load","Prefab","err","asset","callback","time","timer","clickLock","event","setTimeout","TOUCH_END","TOUCH_CANCEL","ms","mitt","Sizes","低难度","中难度","高难度","Thunders","Layout","__blockSize","__windowSize","__startX","__startY","__TopBar","__thunders","__level","__blocks","__startTime","__initialBlocks","__startTimer","__initBlocks","prefab","loadPrefab","totalBlock","i","instantiate","__startGame","setInterval","flagLabel","TopBarNode","getChildByPath","getChildByName","timeLabel","TopBar","Select","__currentOption","val","_update","immediate","_wx","showLoading","title","_this4","__win","__gameover","Result","Restart","__restart","view","getVisibleSize","hideLoading","__initThunders","totalThunder","Array","fill","sort","__insertBlock","startColorIndex","index","blocks","childrenBlockLen","children","j","__blockScript","Block","pop","setPosition","addChild","setSiblingIndex","next","name","removeFromParent","__removeBlockNode","__showResult","info","clearInterval","rank","__options","__buttons","__buttonHeight","__bindReactivity","button","__bindEvent","deep","__initButtons","off","winSize","initOverlay","layout","Node","addComponent","setWorldPosition","parent","Init","Close","len","Time","Rank","__Widget","__initSize","__active","__optionComp","Current","Options","__onSelect","input","options","watch","Proxy","get","_","window","wx","console","warn"],"mappings":"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","file":"all.js","sourcesContent":["import type { EventTouch } from 'cc'\nimport { Button, Color, Component, Input, Label, Sprite, UITransform, Widget, _decorator } from 'cc'\nimport { createEventHandler, emitter, flat, longpress, reactivity, ref } from './Utils'\nimport { Circle } from './CIrcle'\nimport { useThunder } from './Stores'\n\nconst { ccclass, property } = _decorator\n\n@ccclass('Block')\nexport class Block extends Component {\n  __timer = 0\n  __thunderCount = 0\n  __colors = ['#b3d665', '#77A21A']\n  __status = ref<'normal' | 'thunder' | 'flag' | 'diged' >('normal')\n  __isThunder = false\n  __originBlocks: Block[][] = []\n  __position: [number, number] = [0, 0]\n  __thunderColors = ['#DE4EEB', '#4EEBEB', '#4E67EB', '#EBDE4E', '#EB4E4E']\n  __aroundBlockPos: [number, number][] = []\n  __colorIndex = 0\n  __thunderTextColors = ['#085A0E', '#2860F1', '#E5F341', '#F3D741', '#F16928', '#E90B0B', '#C50BE9', '#FF034A']\n\n  __thunderStore = useThunder()\n\n  @property({ type: UITransform })\n  UI: UITransform = null\n\n  @property({ type: Sprite })\n  Sprite: Sprite = null\n\n  @property({ type: Button })\n  Circle: Button\n\n  @property({ type: Label })\n  Text: Label\n\n  __clickLock = ref(false)\n  __debug = false\n\n  __bindReactive() {\n    reactivity(this.__status, nv => {\n      if (nv === 'diged')\n        this.Sprite.color = new Color().fromHEX(this.__colorIndex === 0 ? '#d1b89e' : '#dfc3a3')\n    })\n  }\n\n  __reset() {\n    this.__status.value = 'normal'\n    this.Sprite.color = new Color().fromHEX(this.__colors[this.__colorIndex])\n    this.Text.string = ''\n    this.Circle.node.active = false\n    clearTimeout(this.__timer)\n    this.__thunderCount = 0\n  }\n\n  start() {\n    this.node.on(Input.EventType.TOUCH_START, (e: EventTouch) => {\n      emitter.emit(Input.EventType.TOUCH_START, e)\n    })\n    const button = this.node.getComponent(Button)\n    button.clickEvents.push(createEventHandler({ target: this.node, component: 'Block', handler: 'onClick' }))\n    this.__clickLock = longpress(this.node, () => this.__mark(), 500)\n    this.__bindReactive()\n\n    if (this.__debug) {\n      this.__computeAroundThunderCount()\n      this.Text.string = this.__thunderCount.toString()\n      if (this.__isThunder)\n        this.__digThunder()\n    }\n  }\n\n  __init() {\n    // this.node.setSiblingIndex(0)\n    this.UI = this.getComponent(UITransform)\n    this.Sprite = this.getComponent(Sprite)\n    this.__reset()\n  }\n\n  __updateInfo([width, height]: [number, number], colorIndex: number) {\n    this.UI.setContentSize(width, height)\n    // this.updateCircleSize(width)\n    this.__colorIndex = colorIndex\n    this.Sprite.color = new Color().fromHEX(this.__colors[colorIndex])\n  }\n\n  __updateCircleSize(size: number) {\n    const ui = this.Circle.node.getComponent(Widget)\n    ui.left = size * 0.27\n    ui.right = size * 0.27\n    ui.top = size * 0.27\n    ui.bottom = size * 0.27\n  }\n\n  onClick() {\n    if (this.__thunderStore.end.value || this.__clickLock.value) return\n    this.__dig()\n  }\n\n  __dig(force = true) {\n    emitter.emit('start')\n    if (this.__status.value !== 'normal') return\n    if (this.__isThunder && force) {\n      this.__digThunder()\n      flat(this.__originBlocks).forEach(block => block.__digThunder())\n      emitter.emit('gameover')\n      this.__thunderStore.end.value = true\n      return\n    }\n    this.__computeAroundThunderCount()\n    this.__status.value = 'diged'\n\n    this.Sprite.color = new Color().fromHEX('#FFFFFF')\n\n    if (this.__thunderCount === 0)\n      { this.__digAround() }\n     else\n      {\n        this.Text.string = this.__thunderCount.toString()\n        this.Text.color = new Color().fromHEX(this.__thunderTextColors[this.__thunderCount - 1])\n      }\n\n    this.__thunderStore.digedCount.value++\n\n    if (this.__isWin())\n      emitter.emit('win')\n  }\n\n  __isWin() {\n    return (this.__thunderStore.digedCount.value === this.__thunderStore.totalCount.value - this.__thunderStore.thunderCount.value)\n  }\n\n  __digThunder() {\n    if (this.__isThunder && (this.__status.value === 'normal' || this.__status.value === 'flag')) {\n      this.__status.value = 'thunder'\n      this.__showCircle()\n      this.Text.string = ''\n      this.Sprite.color = new Color().fromHEX(this.__thunderColors[Math.floor(Math.random() * this.__thunderColors.length)])\n    }\n  }\n\n  __showCircle() {\n    const circle = this.Circle.getComponent(Circle)\n    circle.show()\n  }\n\n  __digAround() {\n    for (const [x, y] of this.__aroundBlockPos) {\n      const block = this.__originBlocks[x]?.[y]\n      if (block && block.__status.value === 'normal')\n        block.__dig(false)\n    }\n  }\n\n  __mark() {\n    if (this.__thunderStore.end.value) return\n    if (this.__status.value !== 'flag' && this.__status.value !== 'normal') return\n    this.__status.value = this.__status.value === 'flag' ? 'normal' : 'flag'\n    if (this.__status.value === 'flag') {\n      this.Text.string = '🚩'\n      this.__thunderStore.flagCount.value++\n    } else {\n      this.Text.string = ''\n      this.__thunderStore.flagCount.value--\n    }\n  }\n\n  __computeAroundThunderCount() {\n    const [x, y] = this.__position\n    this.__aroundBlockPos = [\n      [x - 1, y - 1],\n      [x - 1, y],\n      [x - 1, y + 1],\n      [x, y - 1],\n      [x, y + 1],\n      [x + 1, y - 1],\n      [x + 1, y],\n      [x + 1, y + 1]\n    ]\n\n    for (const [x, y] of this.__aroundBlockPos) {\n      const block = this.__originBlocks[x]?.[y]\n      if (block && this.__originBlocks[x][y].__isThunder) this.__thunderCount++\n    }\n  }\n}\n\n","import { Component, _decorator } from 'cc'\nconst { ccclass } = _decorator\n\n@ccclass('Circle')\nexport class Circle extends Component {\n  show() {\n    this.node.active = true\n  }\n}\n\n","import { ref } from '../Utils'\n\nconst thunder = () => {\n  const flagCount = ref(0)\n  const totalCount = ref(0)\n  const digedCount = ref(0)\n  const thunderCount = ref(0)\n  const end = ref(false)\n\n  const reset = () => {\n    flagCount.value = 0\n    totalCount.value = 0\n    digedCount.value = 0\n    thunderCount.value = 0\n    end.value = false\n  }\n\n  return () => {\n    return {\n      flagCount,\n      totalCount,\n      digedCount,\n      thunderCount,\n      end,\n      reset\n    }\n  }\n}\n\nexport const useThunder = thunder()\n\n","import type { EventHandler, EventTouch, Node } from 'cc'\nimport { Component, Input, Prefab, resources } from 'cc'\nimport mitt from 'mitt'\nimport { ref } from './vue'\n\nexport * from './vue'\n\nexport function loadPrefab(path: string): Promise<Prefab> {\n  return new Promise((resolve, reject) => {\n    resources.load(path, Prefab, (err, asset) => {\n      if (err)\n        reject(err)\n       else\n        resolve(asset)\n    })\n  })\n}\n\nexport function sleep(ms: number): Promise<void> {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      resolve()\n    }, ms)\n  })\n}\n\nexport function flat<T>(arr: T[][]): T[] {\n  return arr.reduce((prev, cur) => prev.concat(cur), [])\n}\n\nexport const emitter = mitt()\n\nexport function longpress(target: Node, callback: (e: EventTouch) => void, time = 1000) {\n  let timer: any\n  const clickLock = ref(false)\n  target.on(Input.EventType.TOUCH_START, (event: EventTouch) => {\n    clearTimeout(timer)\n    timer = setTimeout(() => {\n      callback(event)\n      clickLock.value = true\n    }, time)\n  })\n  target.on(Input.EventType.TOUCH_END, () => {\n    clickLock.value = false\n    clearTimeout(timer)\n  })\n  target.on(Input.EventType.TOUCH_CANCEL, () => {\n    clickLock.value = false\n    clearTimeout(timer)\n  })\n  return clickLock\n}\n\nexport function createEventHandler(option: Partial<EventHandler>) {\n  const handler = new Component.EventHandler()\n  for (const key in option)\n    handler[key] = option[key]\n  return handler\n}\n","import type { Node } from 'cc'\nimport { Button, Component, Label, Layout, UITransform, _decorator, instantiate, view } from 'cc'\nimport { emitter, loadPrefab, reactivity, ref } from './Utils'\nimport { Block } from './Block'\nimport type { Info } from './Result/Result'\nimport { Result } from './Result/Result'\nimport { useThunder } from './Stores'\nimport { Select } from './Select/Select'\nimport { TopBar } from './TopBar'\nimport { _wx } from './Wx'\n\nconst Sizes = {\n  低难度: 10,\n  中难度: 14,\n  高难度: 18\n}\n\nconst Thunders = {\n  低难度: 20,\n  中难度: 40,\n  高难度: 99\n}\n\nconst { ccclass, property } = _decorator\n\n@ccclass('Init')\nexport class Init extends Component {\n  __blockSize = 0\n  __windowSize: Record<'width' | 'height', number> = { width: 0, height: 0 }\n  __startX = 0\n  __startY = 0\n  __TopBar: UITransform = null\n  __thunders: boolean[] = []\n  __level = '低难度'\n  __blocks: Node[][] = []\n  __startTime = ref(0)\n  __initialBlocks: Node[] = []\n  __thunderStore = useThunder()\n\n  @property({ type: Button })\n  Restart: Button\n\n  @property({ type: Layout })\n  Result: Layout\n\n  @property({ type: Layout })\n  TopBarNode: Layout\n\n  __startTimer: any = 0\n\n  async __initBlocks() {\n    const prefab = await loadPrefab('prefab/Block')\n    const totalBlock = Sizes['高难度'] ** 2\n    for (let i = 0; i < totalBlock; i++) {\n      const node = instantiate(prefab)\n      this.__initialBlocks.push(node)\n    }\n  }\n\n  __startGame() {\n    if (this.__startTimer) return\n    this.__startTimer = setInterval(() => {\n      this.__startTime.value++\n    }, 1000)\n  }\n\n  __bindReactive() {\n    const flagLabel = this.TopBarNode.node.getChildByPath('Background/Flag').getChildByName('Label')\n    const timeLabel = this.TopBarNode.node.getChildByPath('Background/Time').getChildByName('Label').getComponent(Label)\n    reactivity(this.__thunderStore.flagCount, { key: 'string', node: flagLabel, component: Label })\n    reactivity(this.__startTime, { target: timeLabel, key: 'string' })\n    reactivity(this.TopBarNode.getComponent(TopBar).Select.getComponent(Select).__currentOption, (val: keyof typeof Sizes) => {\n      this.__level = val\n      this._update()\n    }, {\n      immediate: false\n    })\n  }\n\n  async start() {\n    _wx.showLoading({\n      title: '正在初始化数据'\n    })\n    await this.__initBlocks()\n    this.__bindReactive()\n\n    emitter.on('win', () => this.__win())\n\n    emitter.on('gameover', () => this.__gameover())\n    emitter.on('start', () => this.__startGame())\n    this.Result.node.active = false\n    this.Restart.node.on('click', () => {\n      this.__restart()\n    }, this)\n\n    this.__windowSize = view.getVisibleSize()\n    this.__startX = -(this.__windowSize.width / 2)\n    this.__TopBar = this.node.getChildByName('TopBar').getComponent(UITransform)\n    this.__startY = -this.__TopBar.height\n    this._update()\n    _wx.hideLoading()\n  }\n\n  __initThunders() {\n    const totalBlock = Sizes[this.__level] ** 2\n    const totalThunder = Thunders[this.__level]\n    this.__thunderStore.thunderCount.value = totalThunder\n    this.__thunders = new Array(totalBlock - totalThunder).fill(false).concat(new Array(totalThunder).fill(true)).sort(() => Math.random() - 0.5).sort(() => Math.random() - 0.5).sort(() => Math.random() - 0.5)\n    this.__thunderStore.thunderCount.value = totalThunder\n    this.__thunderStore.totalCount.value = totalBlock\n  }\n\n  async __insertBlock() {\n    // const prefab = await loadPrefab('prefab/Block')\n    let startColorIndex = 1\n    let colorIndex = 0\n    let index = 0\n    const blocks: Block[][] = []\n    this.__blocks = []\n\n    // const totalBlock = Sizes[this.level] ** 2\n    const childrenBlockLen = this.node.children.length - 2\n    for (let i = 0; i < Sizes[this.__level]; i++) {\n      startColorIndex = (startColorIndex + 1) % 2\n      colorIndex = (startColorIndex + 1) % 2\n      blocks[i] = []\n      this.__blocks[i] = []\n      for (let j = 0; j < Sizes[this.__level]; j++) {\n        colorIndex = (colorIndex + 1) % 2\n        const block = this.__initialBlocks[index]\n        const __blockScript = block.getComponent(Block)\n        blocks[i][j] = __blockScript\n        this.__blocks[i][j] = block\n        __blockScript.__init()\n        __blockScript.__updateInfo([this.__blockSize, this.__blockSize], colorIndex)\n        __blockScript.__position = [i, j]\n        __blockScript.__originBlocks = blocks\n        __blockScript.__isThunder = this.__thunders.pop()\n        block.setPosition(i * this.__blockSize + this.__startX, -((j + 1) * this.__blockSize) + this.__startY)\n        // debugger\n        if (index >= childrenBlockLen)\n          this.node.addChild(block)\n\n        block.setSiblingIndex(0)\n        index++\n      }\n    }\n    let next = this.__initialBlocks[index]\n    while (next) {\n      if (next.name === 'Block')\n        next.removeFromParent()\n      index++\n      next = this.__initialBlocks[index]\n    }\n  }\n\n  _update() {\n    this.__startTime.value = 0\n    this.__thunderStore.end.value = false\n    this.__blockSize = this.__windowSize.width / Sizes[this.__level]\n    this.__removeBlockNode()\n    this.__thunderStore.reset()\n    this.__initThunders()\n    this.__insertBlock()\n  }\n\n  __removeBlockNode() {\n    // for (let i = 0; i < this.node.children.length; i++) {\n    //   const child = this.node.children[i]\n    //   if (child.name === 'Block')\n    //     // child.destroy()\n    //     child.removeFromParent()\n    // }\n  }\n\n  __restart() {\n    this._update()\n  }\n\n  __showResult(info: Info) {\n    this.Result.node.active = true\n    const result = this.Result.getComponent(Result)\n    result.__updateInfo(info)\n    // this.startTime.value = 0\n  }\n\n  __win() {\n    clearInterval(this.__startTimer)\n    this.__thunderStore.end.value = true\n    this.__startTimer = 0\n    const info = {\n      time: `${this.__startTime.value}S`,\n      rank: '暂无'\n    }\n    this.__showResult(info)\n  }\n\n  __gameover() {\n    clearInterval(this.__startTimer)\n    this.__thunderStore.end.value = true\n    this.__startTimer = 0\n    const info = {\n      time: '--',\n      rank: '--'\n    } as Info\n    this.__showResult(info)\n  }\n}\n","import { Component, UITransform, _decorator, view } from 'cc'\nconst { ccclass } = _decorator\n\n@ccclass('Mask')\nexport class Mask extends Component {\n  start() {\n    const { width, height } = view.getVisibleSize()\n    this.node.getComponent(UITransform).setContentSize(width, height)\n  }\n}\n\n","import type { Node } from 'cc'\nimport { Component, Label, UITransform, Widget, _decorator, instantiate } from 'cc'\n\nimport type { Ref } from '../Utils'\nimport { emitter, loadPrefab, reactivity, ref } from '../Utils'\nconst { ccclass } = _decorator\n\n@ccclass('Options')\nexport class Options extends Component {\n  __options: Ref<string[]>\n\n  __buttons: readonly Node[]\n  __buttonHeight = ref(0)\n\n  __bindReactivity() {\n    reactivity(this.__options, val => {\n      this.__buttons.forEach((button, i) => {\n        this.__bindEvent(button, val[i])\n        button.getChildByPath('Label').getComponent(Label).string = val[i]\n      })\n    }, { deep: true })\n\n    reactivity(this.__buttonHeight, { target: this.node.getComponent(UITransform), key: 'height' })\n  }\n\n  async start() {\n    this.__buttons = this.node.children\n    await this.__initButtons()\n    this.__bindReactivity()\n    this.node.getComponent(Widget).top = this.__buttonHeight.value / this.__options.value.length\n  }\n\n  __bindEvent(node: Node, value: string) {\n    node.off('click')\n    node.on('click', () => this.onClick(value))\n  }\n\n  onClick(value: string) {\n    emitter.emit('select', value)\n  }\n\n  async __initButtons() {\n    const prefab = await loadPrefab('prefab/Option')\n    let height = 0\n    this.__options.value.forEach((option, index) => {\n      const button = instantiate(prefab)\n      this.node.addChild(button)\n      this.__bindEvent(button, option)\n      height = button.getComponent(UITransform).height\n      button.getComponent(Widget).top = height * index\n      button.getChildByPath('Label').getComponent(Label).string = option\n    })\n    this.__buttonHeight = ref(height * this.__options.value.length)\n  }\n}\n\n","import { Color, Component, Node, Sprite, UITransform, _decorator, view } from 'cc'\nconst { ccclass } = _decorator\n\n@ccclass('Overlay')\nexport class Overlay extends Component {\n  winSize = view.getVisibleSize()\n\n  start() {\n    this.initOverlay()\n  }\n\n  async initOverlay() {\n    const layout = new Node('layout')\n    layout.addComponent(UITransform)\n    layout.getComponent(UITransform).setContentSize(this.winSize.width, this.winSize.height)\n    layout.addComponent(Sprite)\n    layout.getComponent(Sprite).color = new Color(0, 0, 0, 0.5)\n    this.node.addChild(layout)\n    layout.setSiblingIndex(2)\n    layout.setWorldPosition(0, 0, 0)\n  }\n}\n\n","import { Button, Component, Label, Layout, _decorator } from 'cc'\nimport { Init } from '../Init'\n\nconst { ccclass, property } = _decorator\n\n@ccclass('Result')\nexport class Result extends Component {\n  @property({ type: Layout })\n  Time: Layout\n\n  @property({ type: Layout })\n  Rank: Layout\n\n  @property({ type: Button })\n  Restart: Button\n\n  @property({ type: Button })\n  Close: Button\n\n  start() {\n    this.Restart.node.on('click', () => {\n      this.node.parent.getComponent(Init).__restart()\n      this.node.active = false\n    }, this)\n\n    this.Close.node.on('click', () => {\n      this.node.active = false\n    })\n  }\n\n  __updateInfo(info: Info) {\n    const len = this.node.parent.children.length\n    this.node.setSiblingIndex(len - 1)\n    this.Time.node.getChildByName('Label').getComponent(Label).string = `${info.time}`\n    this.Rank.node.getChildByName('Label').getComponent(Label).string = `排名: ${info.rank}`\n  }\n}\n\nexport interface Info {\n  time: string\n  rank: string | number\n}\n\n","import { Button, Component, Input, Label, Layout, UITransform, Widget, _decorator, input } from 'cc'\nimport { emitter, reactivity, ref } from '../Utils'\nimport { Options } from './Option'\n\nconst { ccclass, property } = _decorator\n\n@ccclass('Select')\nexport class Select extends Component {\n  @property({ type: Layout })\n  Options: Layout\n\n  @property({ type: Button })\n  Current: Button\n\n  __Widget: Widget\n  __initSize = { top: 0, bottom: 0 }\n  __active = ref(false)\n  __currentOption = ref('低难度')\n  __optionComp: Options\n  __options = ref(['低难度', '中难度', '高难度'])\n\n  __bindReactivity() {\n    reactivity(this.__currentOption, { target: this.Current.node.getChildByPath('Label').getComponent(Label), key: 'string' })\n    reactivity(this.__active, val => {\n      if (val) this.__Widget.bottom = -this.__optionComp.__buttonHeight.value + this.__initSize.bottom\n      else this.__Widget.bottom = this.__initSize.bottom\n      this.Options.getComponent(Widget).top = this.Current.getComponent(UITransform).height\n      this.Current.getComponent(Widget).top = 0\n    })\n  }\n\n  start() {\n    this.__Widget = this.node.getComponent(Widget)\n    this.__initSize = { top: this.__Widget.top, bottom: this.__Widget.bottom }\n    this.__optionComp = this.Options.node.getComponent(Options)\n    this.__optionComp.__options = this.__options\n    this.Current.node.on('click', () => {\n      this.__active.value = !this.__active.value\n    })\n    emitter.on('select', (value: string) => this.__onSelect(value))\n    this.Current.node.getChildByPath('Label').getComponent(Label).string = this.__currentOption.value\n    this.__bindReactivity()\n    input.on(Input.EventType.TOUCH_START, () => {\n      this.__active.value = false\n    })\n\n    emitter.on(Input.EventType.TOUCH_START, () => {\n      this.__active.value = false\n    })\n  }\n\n  __onSelect(value: string) {\n    this.__currentOption.value = value\n    this.__active.value = false\n  }\n}\n\n","import { Component, Layout, Widget, _decorator } from 'cc'\nconst { ccclass, property } = _decorator\n\n@ccclass('TopBar')\nexport class TopBar extends Component {\n  @property({ type: Layout })\n  Select: Layout\n\n  start() {\n    const widget = this.node.getComponent(Widget)\n    widget.left = 1\n  }\n}\n\n","/* eslint-disable-next-line @typescript-eslint/consistent-type-imports */\nimport { Button, Canvas, EditBox, Label, Layout, Node, PageView, ProgressBar, RichText, ScrollView, Slider, Sprite, Toggle, UITransform, VideoPlayer, WebView, Widget } from 'cc'\nimport type { Ref, WatchOptions } from '../../packages/vue.mjs.js' // /dist/vue.esm-browser\nimport { watch } from '../../packages/vue.min.mjs'\n\nexport function reactivity<T>(ref: Ref<T>, callback: Fn<T>, options?: WatchOptions): void\nexport function reactivity<T, C extends Component>(ref: Ref<T>, target: ReactiveTarget<C>, options?: WatchOptions): void\nexport function reactivity<T, C extends Component>(ref: Ref<T>, target: ReactiveTarget<C> | ((val: T) => void), options?: WatchOptions) {\n  watch(() => ref.value, val => {\n    if (typeof target === 'function')\n      {\n        target(val)\n      }\n    else\n      {\n        if (target.component)\n          target.target = target.node.getComponent<C>(target.component)\n\n        target.target[target.key] = val\n      }\n  }, { immediate: true, ...options })\n}\n\ninterface ReactiveTarget<C extends Component> {\n  target?: Component\n  key: string | symbol\n  component?: { new (): C }\n  node?: Node\n}\n\ntype Fn<T> = (val: T) => void\n\ntype Component = Label | UITransform | Layout | Sprite | Button | Canvas | EditBox | PageView | ProgressBar | RichText | ScrollView | Slider | Toggle | VideoPlayer | WebView | Widget\n\nexport * from '../../packages/vue.mjs'\n","export const _wx: typeof wx = new Proxy({} as typeof wx, {\n  get(_, key: string) {\n    return window.wx?.[key] || (() => console.warn(`wx.${key} is called`))\n  }\n})\n\n"]}